(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    142356,       3440]
NotebookOptionsPosition[    140340,       3376]
NotebookOutlinePosition[    140711,       3392]
CellTagsIndexPosition[    140668,       3389]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Initialization and Auxiliary Functions ", "Chapter",
 CellChangeTimes->{{3.722815494606551*^9, 3.7228155094913073`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetDirectory", "[", 
   RowBox[{"NotebookDirectory", "[", "]"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Needs", "[", "\"\<NDSolve`FEM`\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetDirectory", "[", 
   RowBox[{"NotebookDirectory", "[", "]"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"carttopolar", "=", 
   RowBox[{"Function", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"x1", ",", "y1"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"x", ",", "y"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"x", ",", "y"}], "}"}], "=", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"x1", ",", "y1"}], "}"}], "+", 
          RowBox[{"RandomReal", "[", 
           SuperscriptBox["10", 
            RowBox[{"-", "10"}]], "]"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"rholder", "=", 
         RowBox[{
          RowBox[{"Sqrt", "[", 
           RowBox[{
            RowBox[{"x", "^", "2"}], "+", 
            RowBox[{"y", "^", "2"}]}], "]"}], "//", "N"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"\[Theta]holder", "=", 
         RowBox[{
          RowBox[{"Abs", "@", 
           RowBox[{"ArcTan", "[", 
            RowBox[{"y", "/", "x"}], "]"}]}], "//", "N"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"y", ">", "0"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"x", ">", "0"}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"\[Theta]holder", "=", "\[Theta]holder"}], ";"}], 
             "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"\[Theta]holder", "=", 
               RowBox[{"Pi", "-", "\[Theta]holder"}]}], ";"}]}], 
            "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"x", "<", "0"}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"\[Theta]holder", "=", 
               RowBox[{"Pi", "+", "\[Theta]holder"}]}], ";"}], 
             "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"\[Theta]holder", "=", 
               RowBox[{
                RowBox[{"2", "Pi"}], "-", "\[Theta]holder"}]}], ";"}]}], 
            "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
         "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"rholder", ",", "\[Theta]holder"}], "}"}]}]}], 
      "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"polartocart", "[", 
    RowBox[{"rpos_", ",", "\[Theta]pos_"}], "]"}], ":=", 
   RowBox[{"rpos", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Cos", "[", "\[Theta]pos", "]"}], ",", 
      RowBox[{"Sin", "[", "\[Theta]pos", "]"}]}], "}"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"polartocartlist", "[", 
    RowBox[{"{", 
     RowBox[{"rpos_", ",", "\[Theta]pos_"}], "}"}], "]"}], ":=", 
   RowBox[{"rpos", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Cos", "[", "\[Theta]pos", "]"}], ",", 
      RowBox[{"Sin", "[", "\[Theta]pos", "]"}]}], "}"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"DPlot", "[", "fn_", "]"}], ":=", 
   RowBox[{"DensityPlot", "[", 
    RowBox[{
     RowBox[{"fn", "[", 
      RowBox[{"x", ",", "y"}], "]"}], ",", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"x", ",", "y"}], "}"}], "\[Element]", "region"}], ",", 
     RowBox[{"ColorFunction", "\[Rule]", "\"\<SunsetColors\>\""}], ",", 
     RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
     RowBox[{"PlotPoints", "\[Rule]", "50"}], ",", 
     RowBox[{"PlotLegends", "\[Rule]", "Automatic"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"NearestSphere", "=", 
   RowBox[{"Function", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "pt", ",", "R", ",", "\[Theta]start", ",", "\[Theta]end", ",", 
       "\[Phi]start", ",", "\[Phi]end", ",", "n"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"ptslist", ",", "d\[Theta]", ",", "d\[Phi]"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"d\[Theta]", "=", 
         FractionBox[
          RowBox[{"\[Theta]end", "-", "\[Theta]start"}], "n"]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"d\[Phi]", "=", 
         FractionBox[
          RowBox[{"\[Phi]end", "-", "\[Phi]start"}], "n"]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"ptslist", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"R", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"Sin", "[", "\[Theta]", "]"}], 
               RowBox[{"Cos", "[", "\[Phi]", "]"}]}], ",", 
              RowBox[{
               RowBox[{"Sin", "[", "\[Theta]", "]"}], 
               RowBox[{"Sin", "[", "\[Phi]", "]"}]}], ",", 
              RowBox[{"-", 
               RowBox[{"Cos", "[", "\[Theta]", "]"}]}]}], "}"}]}], ",", 
           RowBox[{"{", 
            RowBox[{
            "\[Theta]", ",", "\[Theta]start", ",", "\[Theta]end", ",", 
             "d\[Theta]"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
            "\[Phi]", ",", "\[Phi]start", ",", "\[Phi]end", ",", "d\[Phi]"}], 
            "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"ptslist", "=", 
         RowBox[{"Flatten", "[", 
          RowBox[{"ptslist", ",", "1"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Nearest", "[", 
         RowBox[{"ptslist", ",", "pt"}], "]"}]}]}], "\[IndentingNewLine]", 
      "]"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"NearestSphere", "=", 
   RowBox[{"Function", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"pt", ",", "R", ",", "\[Theta]0", ",", "\[Phi]0"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"\[Theta]sol", ",", "\[Phi]sol"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"\[Theta]sol", ",", "\[Phi]sol"}], "}"}], "=", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"\[Theta]", ",", "\[Phi]"}], "}"}], "/.", 
          RowBox[{
           RowBox[{"FindMinimum", "[", 
            RowBox[{
             RowBox[{"Total", "[", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"pt", "-", 
                 RowBox[{"R", " ", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
                    RowBox[{"Cos", "[", "\[Phi]", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Sin", "[", "\[Theta]", "]"}], 
                    RowBox[{"Sin", "[", "\[Phi]", "]"}]}], ",", 
                    RowBox[{"-", 
                    RowBox[{"Cos", "[", "\[Theta]", "]"}]}]}], "}"}]}]}], 
                ")"}], "^", "2"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"\[Theta]", ",", "\[Theta]0"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"\[Phi]", ",", "\[Phi]0"}], "}"}]}], "}"}], ",", 
             RowBox[{"AccuracyGoal", "\[Rule]", "20"}], ",", 
             RowBox[{"PrecisionGoal", "\[Rule]", "20"}]}], "]"}], "[", 
           RowBox[{"[", "2", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"R", " ", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
             RowBox[{"Cos", "[", "\[Phi]", "]"}]}], ",", 
            RowBox[{
             RowBox[{"Sin", "[", "\[Theta]", "]"}], 
             RowBox[{"Sin", "[", "\[Phi]", "]"}]}], ",", 
            RowBox[{"-", 
             RowBox[{"Cos", "[", "\[Theta]", "]"}]}]}], "}"}]}], "/.", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"\[Theta]", "\[Rule]", "\[Theta]sol"}], ",", 
           RowBox[{"\[Phi]", "\[Rule]", "\[Phi]sol"}]}], "}"}]}]}]}], 
      "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"NearestSphere", "=", 
   RowBox[{"Function", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"pt", ",", "R"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "\[Theta]", ",", "\[Phi]", ",", "x", ",", "y", ",", "z", ",", "r"}], 
        "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"x", ",", "y", ",", "z"}], "}"}], "=", "pt"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"r", "=", 
         RowBox[{"Sqrt", "[", 
          RowBox[{
           RowBox[{"x", "^", "2"}], "+", 
           RowBox[{"y", "^", "2"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"\[Theta]", "=", 
         RowBox[{"Abs", "@", 
          RowBox[{"ArcTan", "[", 
           RowBox[{"r", "/", "z"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"x", "<", "0"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"\[Theta]", "=", 
            RowBox[{"-", "\[Theta]"}]}], ";"}]}], "\[IndentingNewLine]", 
         "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"\[Phi]", "=", 
         RowBox[{
          RowBox[{"carttopolar", "[", 
           RowBox[{"x", ",", "y"}], "]"}], "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"r", " ", 
           RowBox[{"Cos", "[", "\[Phi]", "]"}]}], ",", 
          RowBox[{"r", " ", 
           RowBox[{"Sin", "[", "\[Phi]", "]"}]}], ",", 
          RowBox[{"-", 
           RowBox[{"Sqrt", "[", 
            RowBox[{
             RowBox[{"R", "^", "2"}], "-", 
             RowBox[{"r", "^", "2"}]}], "]"}]}]}], "}"}]}]}], 
      "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BiaTFFT", "=", 
   RowBox[{"Function", "[", 
    RowBox[{
     RowBox[{"{", "list", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"tlist", "=", 
       RowBox[{"list", "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", "1"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"xlist", "=", 
       RowBox[{"list", "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", "2"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"maxf", "=", 
       RowBox[{"1", "/", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"tlist", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "-", 
          RowBox[{"tlist", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"minf", "=", 
       FractionBox["1", 
        RowBox[{
         RowBox[{"tlist", "[", 
          RowBox[{"[", 
           RowBox[{"-", "1"}], "]"}], "]"}], "-", 
         RowBox[{"tlist", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}]]}], ";", "\[IndentingNewLine]", 
      RowBox[{"freqlist", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"minf", "+", 
          RowBox[{
           FractionBox["i", 
            RowBox[{"Length", "@", "list"}]], 
           RowBox[{"(", 
            RowBox[{"maxf", "-", "minf"}], ")"}]}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"Length", "@", "list"}], ",", "1"}], "}"}]}], "]"}]}], ";",
       "\[IndentingNewLine]", 
      RowBox[{"output", "=", 
       RowBox[{"Abs", "@", 
        RowBox[{"Fourier", "[", "xlist", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"output", "=", 
       RowBox[{"Transpose", "[", 
        RowBox[{"{", 
         RowBox[{"freqlist", ",", "output"}], "}"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"output", "[", 
       RowBox[{"[", 
        RowBox[{"1", ";;", 
         RowBox[{"Round", "[", 
          FractionBox[
           RowBox[{"Length", "@", "output"}], "2"], "]"}]}], "]"}], "]"}]}]}],
     "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{3.723172733653894*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Define Parameters", "Chapter",
 CellChangeTimes->{{3.7228155209215584`*^9, 3.7228155232939787`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Rho]", "=", "1200."}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"r", "=", "0.003"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"i", "=", 
   RowBox[{"2.13362", "*", 
    RowBox[{"10", "^", 
     RowBox[{"-", "11"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"m", "=", "0.033"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Emodulus", "=", 
   RowBox[{"3.67", "*", 
    RowBox[{"10", "^", "9"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"EI", "=", 
   RowBox[{"Emodulus", " ", "i"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"EI", "=", "0.095"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"R", "=", "0.2"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"l", "=", "0.815"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Mu]", "=", 
   RowBox[{"8.41", "*", 
    SuperscriptBox["10", 
     RowBox[{"-", "3"}]]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mbeam", "=", 
   RowBox[{"\[Mu]", " ", "l"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cDamping", "=", "0.0175"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"k1", "=", "0.00053"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"k2", "=", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Alpha]", "=", 
   RowBox[{
    RowBox[{"42", " ", "Degree"}], "//", "N"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Alpha]angle", "=", "\[Alpha]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"g", "=", "9.81"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Lambda]", "=", 
   RowBox[{"m", " ", 
    RowBox[{"g", "/", 
     RowBox[{"Tan", "[", "\[Alpha]", "]"}]}], "*", "1"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"a", "=", 
   RowBox[{"EI", "/", 
    SuperscriptBox["l", "4"]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"b", "=", 
    RowBox[{"\[Lambda]", "/", 
     SuperscriptBox["l", "2"]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Gamma]guess", "=", 
   FractionBox[
    RowBox[{"3", 
     RowBox[{"EI", "/", 
      SuperscriptBox["l", "3"]}]}], 
    RowBox[{
     FractionBox[
      RowBox[{"3", "\[Mu]", " ", "l"}], 
      SuperscriptBox["1.875", "4"]], "+", "m"}]]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"d\[Gamma]", "=", 
   RowBox[{"\[Gamma]guess", "/", "10"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Gamma]table", "=", 
   RowBox[{"Quiet", "@", 
    RowBox[{"Table", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"Clear", "[", "\[Psi]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"\[Gamma]", "=", "variable"}], ";", "\[IndentingNewLine]", 
       RowBox[{"c", "=", 
        RowBox[{"\[Mu]", " ", "\[Gamma]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"\[Psi]fn", "=", 
        RowBox[{
         RowBox[{"DSolveValue", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"a", " ", 
                RowBox[{
                 RowBox[{"\[Psi]", "''''"}], "[", "x", "]"}]}], "+", 
               RowBox[{"b", " ", 
                RowBox[{
                 RowBox[{"\[Psi]", "''"}], "[", "x", "]"}]}], "-", " ", 
               RowBox[{"c", " ", 
                RowBox[{"\[Psi]", "[", "x", "]"}]}]}], "\[Equal]", "0"}], ",", 
             RowBox[{
              RowBox[{"\[Psi]", "[", "0", "]"}], "\[Equal]", "0"}], ",", 
             RowBox[{
              RowBox[{
               RowBox[{"\[Psi]", "'"}], "[", "0", "]"}], "\[Equal]", "0"}], 
             ",", 
             RowBox[{
              RowBox[{
               RowBox[{"\[Psi]", "''"}], "[", "1", "]"}], "\[Equal]", "0"}]}],
             "}"}], ",", 
           RowBox[{"\[Psi]", "[", "x", "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"x", ",", "0.", ",", "1"}], "}"}]}], "]"}], "/.", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"C", "[", "1", "]"}], "\[Rule]", "1"}], "}"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"d3\[Psi]dx3", "[", "x_", "]"}], "=", 
        RowBox[{"D", "[", 
         RowBox[{"\[Psi]fn", ",", 
          RowBox[{"{", 
           RowBox[{"x", ",", "3"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"d\[Psi]dx", "[", "x_", "]"}], "=", 
        RowBox[{"D", "[", 
         RowBox[{"\[Psi]fn", ",", "x"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"output", "=", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"EI", " ", 
            RowBox[{
             RowBox[{"d3\[Psi]dx3", "[", "1", "]"}], "/", 
             SuperscriptBox["l", "3"]}]}], "+", 
           RowBox[{"\[Lambda]", 
            RowBox[{
             RowBox[{"(", " ", 
              RowBox[{
               RowBox[{"d\[Psi]dx", "[", "1", "]"}], "-", "\[Psi]fn"}], ")"}],
              "/", "l"}]}], "+", 
           RowBox[{"m", " ", "\[Gamma]", " ", "\[Psi]fn"}]}], ")"}], "/.", 
         RowBox[{"{", 
          RowBox[{"x", "\[Rule]", "1"}], "}"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"variable", ",", 
         RowBox[{"Re", "@", "output"}]}], "}"}]}], "\[IndentingNewLine]", ",", 
      RowBox[{"{", 
       RowBox[{"variable", ",", "0", ",", 
        RowBox[{"2", "*", "\[Gamma]guess"}], ",", "d\[Gamma]"}], "}"}]}], 
     "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Gamma]int", "=", 
   RowBox[{"Interpolation", "[", "\[Gamma]table", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Gamma]", "=", 
   RowBox[{"Abs", "[", 
    RowBox[{"x", "/.", 
     RowBox[{"FindRoot", "[", 
      RowBox[{
       RowBox[{"\[Gamma]int", "[", "x", "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"x", ",", "\[Gamma]guess"}], "}"}]}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Omega]b", "=", 
    RowBox[{"Sqrt", "[", "\[Gamma]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"d", "=", "0.01953"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"r", "=", 
   RowBox[{"d", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"l1", "=", 
   RowBox[{"0.03345", "-", "d"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"lcm", "=", 
   RowBox[{"R", "+", "l1", "+", "r"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Omega]fn", "[", 
    RowBox[{"l_", ",", "k_"}], "]"}], ":=", 
   RowBox[{"Sqrt", "[", 
    FractionBox[
     RowBox[{"g", " ", 
      RowBox[{"(", 
       RowBox[{"l", "+", "l1", "+", "r"}], ")"}]}], 
     RowBox[{
      RowBox[{
       FractionBox["2", "5"], 
       RowBox[{"r", "^", "2"}]}], "+", "k", "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"l", "+", "l1", "+", "r"}], ")"}], "^", "2"}]}]], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"tPfn", "[", "l_", "]"}], ":=", 
    RowBox[{"2", 
     RowBox[{"Pi", "/", 
      RowBox[{"\[Omega]fn", "[", 
       RowBox[{"l", ",", "0"}], "]"}]}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"period", "=", 
   RowBox[{"2", 
    RowBox[{"Pi", "/", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Sqrt", "[", 
        FractionBox["EI", 
         RowBox[{"\[Mu]", " ", 
          SuperscriptBox["l", "4"]}]], "]"}], "*", 
       RowBox[{"1.875", "^", "2"}]}], ")"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"period1", "=", 
  RowBox[{"2", 
   RowBox[{"Pi", "/", "\[Omega]b"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"period2", "=", 
  RowBox[{"tPfn", "[", "R", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"period1", "/", "period2"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"R", "=", 
   RowBox[{"g", "/", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"2", 
       RowBox[{"Pi", "/", 
        RowBox[{"(", "period2", " ", ")"}]}]}], ")"}], "^", "2"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"2", "Pi", " ", 
  RowBox[{"Sqrt", "[", 
   RowBox[{"R", "/", "g"}], "]"}]}]}], "Input",
 CellChangeTimes->{
  3.7228178860473003`*^9, {3.722825528854427*^9, 3.7228255330918922`*^9}, 
   3.7228269768257236`*^9, {3.7228270495412054`*^9, 3.7228270501567154`*^9}, {
   3.7228272205734234`*^9, 3.722827221815296*^9}, 3.7228276742377405`*^9, {
   3.7228488874744253`*^9, 3.7228488942180905`*^9}, {3.722851101461744*^9, 
   3.7228511477476797`*^9}, {3.722854465255118*^9, 3.722854475305085*^9}, {
   3.722904129834757*^9, 3.722904135066287*^9}, {3.7229048307443857`*^9, 
   3.7229049196495*^9}, {3.722906309125385*^9, 3.7229063429965343`*^9}, {
   3.7230367667269173`*^9, 3.7230367799391613`*^9}, 3.7230369137225013`*^9, {
   3.7230371695732117`*^9, 3.7230371700424585`*^9}, {3.7230375311617327`*^9, 
   3.7230375314700546`*^9}, 3.7231053270827026`*^9, {3.7231083080546083`*^9, 
   3.7231083253188877`*^9}, {3.7233776882795525`*^9, 3.723377688382285*^9}, {
   3.723418005477711*^9, 3.723418056436368*^9}, {3.7241037445446386`*^9, 
   3.7241038362908645`*^9}, {3.724104094255972*^9, 3.724104108107671*^9}, {
   3.7241043020741577`*^9, 3.724104468746194*^9}, {3.724133594009386*^9, 
   3.7241335941352997`*^9}, {3.724141591975836*^9, 3.724141637874833*^9}, {
   3.7242004839659815`*^9, 3.724200497836692*^9}, {3.7242143735976458`*^9, 
   3.7242143738106666`*^9}, {3.7242145653241563`*^9, 
   3.7242145881906013`*^9}, {3.724214677517708*^9, 3.7242147465382776`*^9}, {
   3.724214779422179*^9, 3.7242148102175903`*^9}, {3.724298227971491*^9, 
   3.724298244918191*^9}, {3.7243112703970733`*^9, 3.724311290407856*^9}, {
   3.724333156047471*^9, 3.724333179957728*^9}, {3.7243332100153446`*^9, 
   3.7243332162641544`*^9}, {3.7243752233051004`*^9, 
   3.7243752439266043`*^9}, {3.7243754799993277`*^9, 
   3.7243755457694473`*^9}, {3.7243850752106686`*^9, 3.724385078132484*^9}, {
   3.7244282511823406`*^9, 3.724428275949504*^9}, {3.7244333487607155`*^9, 
   3.724433382919351*^9}, {3.724464761836212*^9, 3.724464809227275*^9}, {
   3.7244648566403646`*^9, 3.7244648722929707`*^9}, 3.7245542827368464`*^9, {
   3.7245565476355376`*^9, 3.7245565823741083`*^9}, {3.7246399165675488`*^9, 
   3.7246399195765295`*^9}, {3.7246405915199738`*^9, 
   3.7246405984339876`*^9}, {3.724794888341967*^9, 3.724794888808564*^9}, {
   3.7247949905707674`*^9, 3.72479506523149*^9}, {3.7247951013309684`*^9, 
   3.724795106500244*^9}, {3.7247951386856523`*^9, 3.724795145546598*^9}, {
   3.7247953755491505`*^9, 3.7247953896878567`*^9}, {3.7248174566249514`*^9, 
   3.72481746234394*^9}, {3.724818338141532*^9, 3.724818343591361*^9}, {
   3.7249138401701097`*^9, 3.7249139035702887`*^9}, {3.7249139424437027`*^9, 
   3.7249139534451685`*^9}, {3.72492072870267*^9, 3.724920728844574*^9}, {
   3.724937944837308*^9, 3.7249379451531334`*^9}, {3.7249395512732964`*^9, 
   3.724939551462346*^9}, {3.724941515135208*^9, 3.724941515511588*^9}, {
   3.7249425259311857`*^9, 3.724942526429796*^9}, {3.7249436727655573`*^9, 
   3.724943672919264*^9}, {3.7250284025407286`*^9, 3.7250284127376137`*^9}, {
   3.7250656894274015`*^9, 3.7250657072625256`*^9}, {3.725065921552462*^9, 
   3.7250659244245977`*^9}, {3.725074544694641*^9, 3.7250745448626165`*^9}, {
   3.725086952242195*^9, 3.7250869616365156`*^9}, {3.7251056933192887`*^9, 
   3.7251056938463416`*^9}, {3.7251065074167557`*^9, 3.725106507892803*^9}, {
   3.7251790477553835`*^9, 3.725179049393405*^9}, {3.725181900994783*^9, 
   3.725181910183301*^9}, 3.7252335153483844`*^9, {3.7252335651130223`*^9, 
   3.725233565799431*^9}, {3.7252337290351796`*^9, 3.7252337296435876`*^9}, {
   3.7252337605284386`*^9, 3.72523376065324*^9}, 3.725599835947384*^9}],

Cell[BoxData["1.7788847328095168`"], "Output",
 CellChangeTimes->{{3.7231083144957933`*^9, 3.7231083291737175`*^9}, 
   3.7231271320311594`*^9, 3.723292827325776*^9, 3.7232961231393433`*^9, 
   3.7233344111346855`*^9, 3.7233411756642857`*^9, {3.7233776664552336`*^9, 
   3.723377688552738*^9}, {3.723418018126046*^9, 3.7234180566125836`*^9}, 
   3.724019900509471*^9, 3.7240201032512455`*^9, 3.724020191834581*^9, {
   3.7241037428332176`*^9, 3.7241038365266213`*^9}, {3.7241040972309103`*^9, 
   3.7241041082654004`*^9}, {3.7241044095322523`*^9, 3.7241044747787523`*^9}, 
   3.72410809420872*^9, 3.7241335956189194`*^9, {3.724141582152224*^9, 
   3.7241416391815853`*^9}, {3.7242004755978537`*^9, 3.7242004993822007`*^9}, 
   3.7242145908912125`*^9, {3.724214666537098*^9, 3.724214747768502*^9}, {
   3.7242147816145086`*^9, 3.724214815803342*^9}, {3.7242982259015684`*^9, 
   3.7242982494885154`*^9}, 3.7243111405053253`*^9, {3.7243112715691214`*^9, 
   3.7243112804145403`*^9}, {3.7243331577103014`*^9, 
   3.7243331812792745`*^9}, {3.724333212157161*^9, 3.7243332176023884`*^9}, {
   3.7243752400327377`*^9, 3.7243752455148263`*^9}, 3.7243755474133277`*^9, 
   3.7243850794662814`*^9, {3.72442825321026*^9, 3.7244282772946515`*^9}, {
   3.72443336514299*^9, 3.724433384755293*^9}, 3.724439999682316*^9, 
   3.7244647732395215`*^9, 3.7244648107222223`*^9, {3.724464863231866*^9, 
   3.7244648736014423`*^9}, 3.724554284300871*^9, {3.724556549063624*^9, 
   3.724556583701597*^9}, {3.7246398984372272`*^9, 3.7246399220280495`*^9}, {
   3.72464059312676*^9, 3.724640600504877*^9}, 3.7247948906185155`*^9, {
   3.724795055549087*^9, 3.7247950665672235`*^9}, 3.7247951474060063`*^9, 
   3.724795391366008*^9, 3.7248174639478045`*^9, {3.7248183402667456`*^9, 
   3.7248183452186627`*^9}, {3.7249138368523645`*^9, 
   3.7249139065805883`*^9}, {3.7249139445030284`*^9, 3.7249139551166525`*^9}, 
   3.724920730153847*^9, 3.724929979897175*^9, 3.724937946540431*^9, 
   3.7249395528469567`*^9, 3.7249415168527093`*^9, 3.724942528364026*^9, 
   3.7249436743843784`*^9, 3.7250658329028254`*^9, {3.7250659183819056`*^9, 
   3.725065926158205*^9}, 3.725074977662406*^9, 3.7250750947688*^9, 
   3.725075124956091*^9, 3.7250755497086377`*^9, 3.7250764179927187`*^9, {
   3.7250766110255613`*^9, 3.7250766213385925`*^9}, 3.725086965209961*^9, {
   3.7251056906280193`*^9, 3.725105695213478*^9}, {3.725106503819396*^9, 
   3.725106508982912*^9}, 3.7251574458992147`*^9, 3.7251790879641*^9, 
   3.725179118435291*^9, {3.7251818979215436`*^9, 3.725181919637022*^9}, 
   3.725233469534995*^9, {3.7252335131019554`*^9, 3.725233516502799*^9}, 
   3.725233567109848*^9, 3.7252337741474133`*^9, 3.725234004140856*^9, 
   3.7255998424683094`*^9, 3.725615141144539*^9}],

Cell[BoxData["0.9491377911617177`"], "Output",
 CellChangeTimes->{{3.7231083144957933`*^9, 3.7231083291737175`*^9}, 
   3.7231271320311594`*^9, 3.723292827325776*^9, 3.7232961231393433`*^9, 
   3.7233344111346855`*^9, 3.7233411756642857`*^9, {3.7233776664552336`*^9, 
   3.723377688552738*^9}, {3.723418018126046*^9, 3.7234180566125836`*^9}, 
   3.724019900509471*^9, 3.7240201032512455`*^9, 3.724020191834581*^9, {
   3.7241037428332176`*^9, 3.7241038365266213`*^9}, {3.7241040972309103`*^9, 
   3.7241041082654004`*^9}, {3.7241044095322523`*^9, 3.7241044747787523`*^9}, 
   3.72410809420872*^9, 3.7241335956189194`*^9, {3.724141582152224*^9, 
   3.7241416391815853`*^9}, {3.7242004755978537`*^9, 3.7242004993822007`*^9}, 
   3.7242145908912125`*^9, {3.724214666537098*^9, 3.724214747768502*^9}, {
   3.7242147816145086`*^9, 3.724214815803342*^9}, {3.7242982259015684`*^9, 
   3.7242982494885154`*^9}, 3.7243111405053253`*^9, {3.7243112715691214`*^9, 
   3.7243112804145403`*^9}, {3.7243331577103014`*^9, 
   3.7243331812792745`*^9}, {3.724333212157161*^9, 3.7243332176023884`*^9}, {
   3.7243752400327377`*^9, 3.7243752455148263`*^9}, 3.7243755474133277`*^9, 
   3.7243850794662814`*^9, {3.72442825321026*^9, 3.7244282772946515`*^9}, {
   3.72443336514299*^9, 3.724433384755293*^9}, 3.724439999682316*^9, 
   3.7244647732395215`*^9, 3.7244648107222223`*^9, {3.724464863231866*^9, 
   3.7244648736014423`*^9}, 3.724554284300871*^9, {3.724556549063624*^9, 
   3.724556583701597*^9}, {3.7246398984372272`*^9, 3.7246399220280495`*^9}, {
   3.72464059312676*^9, 3.724640600504877*^9}, 3.7247948906185155`*^9, {
   3.724795055549087*^9, 3.7247950665672235`*^9}, 3.7247951474060063`*^9, 
   3.724795391366008*^9, 3.7248174639478045`*^9, {3.7248183402667456`*^9, 
   3.7248183452186627`*^9}, {3.7249138368523645`*^9, 
   3.7249139065805883`*^9}, {3.7249139445030284`*^9, 3.7249139551166525`*^9}, 
   3.724920730153847*^9, 3.724929979897175*^9, 3.724937946540431*^9, 
   3.7249395528469567`*^9, 3.7249415168527093`*^9, 3.724942528364026*^9, 
   3.7249436743843784`*^9, 3.7250658329028254`*^9, {3.7250659183819056`*^9, 
   3.725065926158205*^9}, 3.725074977662406*^9, 3.7250750947688*^9, 
   3.725075124956091*^9, 3.7250755497086377`*^9, 3.7250764179927187`*^9, {
   3.7250766110255613`*^9, 3.7250766213385925`*^9}, 3.725086965209961*^9, {
   3.7251056906280193`*^9, 3.725105695213478*^9}, {3.725106503819396*^9, 
   3.725106508982912*^9}, 3.7251574458992147`*^9, 3.7251790879641*^9, 
   3.725179118435291*^9, {3.7251818979215436`*^9, 3.725181919637022*^9}, 
   3.725233469534995*^9, {3.7252335131019554`*^9, 3.725233516502799*^9}, 
   3.725233567109848*^9, 3.7252337741474133`*^9, 3.725234004140856*^9, 
   3.7255998424683094`*^9, 3.725615141144539*^9}],

Cell[BoxData["1.8742112571792264`"], "Output",
 CellChangeTimes->{{3.7231083144957933`*^9, 3.7231083291737175`*^9}, 
   3.7231271320311594`*^9, 3.723292827325776*^9, 3.7232961231393433`*^9, 
   3.7233344111346855`*^9, 3.7233411756642857`*^9, {3.7233776664552336`*^9, 
   3.723377688552738*^9}, {3.723418018126046*^9, 3.7234180566125836`*^9}, 
   3.724019900509471*^9, 3.7240201032512455`*^9, 3.724020191834581*^9, {
   3.7241037428332176`*^9, 3.7241038365266213`*^9}, {3.7241040972309103`*^9, 
   3.7241041082654004`*^9}, {3.7241044095322523`*^9, 3.7241044747787523`*^9}, 
   3.72410809420872*^9, 3.7241335956189194`*^9, {3.724141582152224*^9, 
   3.7241416391815853`*^9}, {3.7242004755978537`*^9, 3.7242004993822007`*^9}, 
   3.7242145908912125`*^9, {3.724214666537098*^9, 3.724214747768502*^9}, {
   3.7242147816145086`*^9, 3.724214815803342*^9}, {3.7242982259015684`*^9, 
   3.7242982494885154`*^9}, 3.7243111405053253`*^9, {3.7243112715691214`*^9, 
   3.7243112804145403`*^9}, {3.7243331577103014`*^9, 
   3.7243331812792745`*^9}, {3.724333212157161*^9, 3.7243332176023884`*^9}, {
   3.7243752400327377`*^9, 3.7243752455148263`*^9}, 3.7243755474133277`*^9, 
   3.7243850794662814`*^9, {3.72442825321026*^9, 3.7244282772946515`*^9}, {
   3.72443336514299*^9, 3.724433384755293*^9}, 3.724439999682316*^9, 
   3.7244647732395215`*^9, 3.7244648107222223`*^9, {3.724464863231866*^9, 
   3.7244648736014423`*^9}, 3.724554284300871*^9, {3.724556549063624*^9, 
   3.724556583701597*^9}, {3.7246398984372272`*^9, 3.7246399220280495`*^9}, {
   3.72464059312676*^9, 3.724640600504877*^9}, 3.7247948906185155`*^9, {
   3.724795055549087*^9, 3.7247950665672235`*^9}, 3.7247951474060063`*^9, 
   3.724795391366008*^9, 3.7248174639478045`*^9, {3.7248183402667456`*^9, 
   3.7248183452186627`*^9}, {3.7249138368523645`*^9, 
   3.7249139065805883`*^9}, {3.7249139445030284`*^9, 3.7249139551166525`*^9}, 
   3.724920730153847*^9, 3.724929979897175*^9, 3.724937946540431*^9, 
   3.7249395528469567`*^9, 3.7249415168527093`*^9, 3.724942528364026*^9, 
   3.7249436743843784`*^9, 3.7250658329028254`*^9, {3.7250659183819056`*^9, 
   3.725065926158205*^9}, 3.725074977662406*^9, 3.7250750947688*^9, 
   3.725075124956091*^9, 3.7250755497086377`*^9, 3.7250764179927187`*^9, {
   3.7250766110255613`*^9, 3.7250766213385925`*^9}, 3.725086965209961*^9, {
   3.7251056906280193`*^9, 3.725105695213478*^9}, {3.725106503819396*^9, 
   3.725106508982912*^9}, 3.7251574458992147`*^9, 3.7251790879641*^9, 
   3.725179118435291*^9, {3.7251818979215436`*^9, 3.725181919637022*^9}, 
   3.725233469534995*^9, {3.7252335131019554`*^9, 3.725233516502799*^9}, 
   3.725233567109848*^9, 3.7252337741474133`*^9, 3.725234004140856*^9, 
   3.7255998424683094`*^9, 3.725615141144539*^9}],

Cell[BoxData["0.9491377911617177`"], "Output",
 CellChangeTimes->{{3.7231083144957933`*^9, 3.7231083291737175`*^9}, 
   3.7231271320311594`*^9, 3.723292827325776*^9, 3.7232961231393433`*^9, 
   3.7233344111346855`*^9, 3.7233411756642857`*^9, {3.7233776664552336`*^9, 
   3.723377688552738*^9}, {3.723418018126046*^9, 3.7234180566125836`*^9}, 
   3.724019900509471*^9, 3.7240201032512455`*^9, 3.724020191834581*^9, {
   3.7241037428332176`*^9, 3.7241038365266213`*^9}, {3.7241040972309103`*^9, 
   3.7241041082654004`*^9}, {3.7241044095322523`*^9, 3.7241044747787523`*^9}, 
   3.72410809420872*^9, 3.7241335956189194`*^9, {3.724141582152224*^9, 
   3.7241416391815853`*^9}, {3.7242004755978537`*^9, 3.7242004993822007`*^9}, 
   3.7242145908912125`*^9, {3.724214666537098*^9, 3.724214747768502*^9}, {
   3.7242147816145086`*^9, 3.724214815803342*^9}, {3.7242982259015684`*^9, 
   3.7242982494885154`*^9}, 3.7243111405053253`*^9, {3.7243112715691214`*^9, 
   3.7243112804145403`*^9}, {3.7243331577103014`*^9, 
   3.7243331812792745`*^9}, {3.724333212157161*^9, 3.7243332176023884`*^9}, {
   3.7243752400327377`*^9, 3.7243752455148263`*^9}, 3.7243755474133277`*^9, 
   3.7243850794662814`*^9, {3.72442825321026*^9, 3.7244282772946515`*^9}, {
   3.72443336514299*^9, 3.724433384755293*^9}, 3.724439999682316*^9, 
   3.7244647732395215`*^9, 3.7244648107222223`*^9, {3.724464863231866*^9, 
   3.7244648736014423`*^9}, 3.724554284300871*^9, {3.724556549063624*^9, 
   3.724556583701597*^9}, {3.7246398984372272`*^9, 3.7246399220280495`*^9}, {
   3.72464059312676*^9, 3.724640600504877*^9}, 3.7247948906185155`*^9, {
   3.724795055549087*^9, 3.7247950665672235`*^9}, 3.7247951474060063`*^9, 
   3.724795391366008*^9, 3.7248174639478045`*^9, {3.7248183402667456`*^9, 
   3.7248183452186627`*^9}, {3.7249138368523645`*^9, 
   3.7249139065805883`*^9}, {3.7249139445030284`*^9, 3.7249139551166525`*^9}, 
   3.724920730153847*^9, 3.724929979897175*^9, 3.724937946540431*^9, 
   3.7249395528469567`*^9, 3.7249415168527093`*^9, 3.724942528364026*^9, 
   3.7249436743843784`*^9, 3.7250658329028254`*^9, {3.7250659183819056`*^9, 
   3.725065926158205*^9}, 3.725074977662406*^9, 3.7250750947688*^9, 
   3.725075124956091*^9, 3.7250755497086377`*^9, 3.7250764179927187`*^9, {
   3.7250766110255613`*^9, 3.7250766213385925`*^9}, 3.725086965209961*^9, {
   3.7251056906280193`*^9, 3.725105695213478*^9}, {3.725106503819396*^9, 
   3.725106508982912*^9}, 3.7251574458992147`*^9, 3.7251790879641*^9, 
   3.725179118435291*^9, {3.7251818979215436`*^9, 3.725181919637022*^9}, 
   3.725233469534995*^9, {3.7252335131019554`*^9, 3.725233516502799*^9}, 
   3.725233567109848*^9, 3.7252337741474133`*^9, 3.725234004140856*^9, 
   3.7255998424683094`*^9, 3.725615141144539*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Define Functions", "Chapter",
 CellChangeTimes->{{3.7228155281275983`*^9, 3.722815529923289*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Needs", "[", "\"\<NDSolve`FEM`\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"opt", "=", 
   RowBox[{"\"\<DifferenceOrder\>\"", "\[Rule]", "4"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"initializeGrid", "=", 
    RowBox[{"Function", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"n", ",", "l"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"ds", "=", 
        RowBox[{"l", "/", "n"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"sGrid", "=", 
        RowBox[{"Range", "[", 
         RowBox[{"0", ",", "l", ",", "ds"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"length", "=", 
        RowBox[{"Length", "@", "sGrid"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"uGrid", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Unique", "[", "\"\<u\>\"", "]"}], ",", "length"}], "]"}]}],
        ";", "\[IndentingNewLine]", 
       RowBox[{"vGrid", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Unique", "[", "\"\<v\>\"", "]"}], ",", "length"}], "]"}]}],
        ";", "\[IndentingNewLine]", 
       RowBox[{"uVelGrid", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Unique", "[", "\"\<uV\>\"", "]"}], ",", "length"}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"vVelGrid", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Unique", "[", "\"\<vV\>\"", "]"}], ",", "length"}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"\[Lambda]Grid", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Unique", "[", "\"\<\[Lambda]\>\"", "]"}], ",", "length"}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"initialU", "=", 
        RowBox[{"ConstantArray", "[", 
         RowBox[{"0.", ",", "length"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"initialV", "=", "initialU"}], ";", "\[IndentingNewLine]", 
       RowBox[{"uVel", "=", "initialU"}], ";", "\[IndentingNewLine]", 
       RowBox[{"vVel", "=", "initialU"}], ";"}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"SystemEnergy", "=", 
    RowBox[{"Function", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "m", ",", "\[Mu]", ",", "dl", ",", "velBob", ",", "Uvel", ",", 
        "Vvel"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"bobEnergy", "=", 
        RowBox[{
         FractionBox["1", "2"], "m", " ", 
         RowBox[{
          RowBox[{"Norm", "[", 
           RowBox[{"velBob", "+", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Uvel", "[", 
               RowBox[{"[", 
                RowBox[{"-", "1"}], "]"}], "]"}], ",", 
              RowBox[{"Vvel", "[", 
               RowBox[{"[", 
                RowBox[{"-", "1"}], "]"}], "]"}], ",", "0"}], "}"}]}], "]"}], 
          "^", "2"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"beamSpeedFn", "=", 
        RowBox[{
         RowBox[{"Uvel", "^", "2"}], "+", 
         RowBox[{"Vvel", "^", "2"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"beamEnergy", "=", 
        RowBox[{"\[Mu]", " ", 
         RowBox[{"Total", "[", "beamSpeedFn", "]"}], "dl"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"bobEnergy", ",", "beamEnergy"}], "}"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"LinearFull\[Lambda]1\[Lambda]2", "=", 
    RowBox[{"Function", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "initialU", ",", "initialV", ",", "uVel", ",", "vVel", ",", "posbob", 
        ",", "velbob", ",", "dt"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"d4fds4", "=", 
        RowBox[{
         RowBox[{"NDSolve`FiniteDifferenceDerivative", "[", 
          RowBox[{"4", ",", "sGrid", ",", "opt"}], "]"}], "[", 
         "\"\<DifferentiationMatrix\>\"", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"d3fds3", "=", 
        RowBox[{
         RowBox[{"NDSolve`FiniteDifferenceDerivative", "[", 
          RowBox[{"3", ",", "sGrid", ",", "opt"}], "]"}], "[", 
         "\"\<DifferentiationMatrix\>\"", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"d2fds2", "=", 
        RowBox[{
         RowBox[{"NDSolve`FiniteDifferenceDerivative", "[", 
          RowBox[{"2", ",", "sGrid", ",", "opt"}], "]"}], "[", 
         "\"\<DifferentiationMatrix\>\"", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"dfds", "=", 
        RowBox[{
         RowBox[{"NDSolve`FiniteDifferenceDerivative", "[", 
          RowBox[{"1", ",", "sGrid", ",", "opt"}], "]"}], "[", 
         "\"\<DifferentiationMatrix\>\"", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"d4vds4", "=", 
        RowBox[{"d4fds4", ".", "vGrid"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"d3vds3", "=", 
        RowBox[{"d3fds3", ".", "vGrid"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"d2vds2", "=", 
        RowBox[{"d2fds2", ".", "vGrid"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"dvds", "=", 
        RowBox[{"dfds", ".", "vGrid"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"duds", "=", 
        RowBox[{"dfds", ".", "uGrid"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"xbob", ",", "ybob", ",", "zbob"}], "}"}], "=", "posbob"}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"vx", ",", "vy", ",", "vz"}], "}"}], "=", "velbob"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"xVar", "=", 
        RowBox[{"Unique", "[", "\"\<xbob\>\"", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"yVar", "=", 
        RowBox[{"Unique", "[", "\"\<ybob\>\"", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"zVar", "=", 
        RowBox[{"Unique", "[", "\"\<zbob\>\"", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"\[Lambda]2Var", "=", 
        RowBox[{"Unique", "[", "\"\<\[Lambda]2\>\"", "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"udot", "=", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"uGrid", "-", 
           RowBox[{"(", 
            RowBox[{"initialU", "+", 
             RowBox[{"uVel", " ", "dt"}]}], ")"}]}], ")"}], "/", "dt"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"vdot", "=", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"vGrid", "-", 
           RowBox[{"(", 
            RowBox[{"initialV", "+", 
             RowBox[{"vVel", " ", "dt"}]}], ")"}]}], ")"}], "/", "dt"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"xdot", "=", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"xVar", "-", 
           RowBox[{"(", 
            RowBox[{"xbob", "+", 
             RowBox[{"vx", " ", "dt"}]}], ")"}]}], ")"}], "/", "dt"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"ydot", "=", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"yVar", "-", 
           RowBox[{"(", 
            RowBox[{"ybob", "+", 
             RowBox[{"vy", " ", "dt"}]}], ")"}]}], ")"}], "/", "dt"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"zdot", "=", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"zVar", "-", 
           RowBox[{"(", 
            RowBox[{"zbob", "+", 
             RowBox[{"vz", " ", "dt"}]}], ")"}]}], ")"}], "/", "dt"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"d2udt2", "=", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"udot", "-", "uVel"}], ")"}], "/", "dt"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"d2vdt2", "=", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"vdot", "-", "vVel"}], ")"}], "/", "dt"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"xddot", "=", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"xdot", "-", "vx"}], ")"}], "/", "dt"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"yddot", "=", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"ydot", "-", "vy"}], ")"}], "/", "dt"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"zddot", "=", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"zdot", "-", "vz"}], ")"}], "/", "dt"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"eqnsU", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "\[Mu]"}], " ", "d2udt2"}], "+", 
         RowBox[{"dfds", ".", 
          RowBox[{"(", 
           RowBox[{"\[Lambda]Grid", 
            RowBox[{"(", 
             RowBox[{"1", "+", "duds"}], ")"}]}], ")"}]}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"eqnsV", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "\[Mu]"}], " ", "d2vdt2"}], "+", 
         RowBox[{"dfds", ".", 
          RowBox[{"(", 
           RowBox[{"\[Lambda]Grid", " ", "dvds"}], ")"}]}], "-", 
         RowBox[{"EI", " ", "d4vds4"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"eqns\[Lambda]", "=", 
        RowBox[{"1", "-", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"1", "+", "duds"}], ")"}], "2"], "-", 
         SuperscriptBox["dvds", "2"]}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"xForce", "=", 
        RowBox[{
         RowBox[{"-", "\[Lambda]Grid"}], 
         RowBox[{"(", 
          RowBox[{"1", "+", "duds"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"yForce", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "\[Lambda]Grid"}], " ", "dvds"}], "+", 
         RowBox[{"EI", " ", "d3vds3"}]}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"eqnsU", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "=", 
        RowBox[{"uGrid", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"eqnsU", "[", 
         RowBox[{"[", 
          RowBox[{"-", "1"}], "]"}], "]"}], "=", 
        RowBox[{
         RowBox[{"xForce", "[", 
          RowBox[{"[", 
           RowBox[{"-", "1"}], "]"}], "]"}], "+", 
         RowBox[{"\[Lambda]2Var", " ", "xVar"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"eqnsV", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "=", 
        RowBox[{"vGrid", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"eqnsV", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "=", 
        RowBox[{"dvds", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"eqnsV", "[", 
         RowBox[{"[", 
          RowBox[{"-", "1"}], "]"}], "]"}], "=", 
        RowBox[{
         RowBox[{"yForce", "[", 
          RowBox[{"[", 
           RowBox[{"-", "1"}], "]"}], "]"}], "+", 
         RowBox[{"\[Lambda]2Var", " ", "yVar"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"eqnsV", "[", 
         RowBox[{"[", 
          RowBox[{"-", "2"}], "]"}], "]"}], "=", 
        RowBox[{"d2vds2", "[", 
         RowBox[{"[", 
          RowBox[{"-", "1"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"eqnA", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "\[Lambda]2Var"}], " ", "xVar"}], "-", 
         RowBox[{"m", 
          RowBox[{"(", 
           RowBox[{"xddot", "+", 
            RowBox[{"d2udt2", "[", 
             RowBox[{"[", 
              RowBox[{"-", "1"}], "]"}], "]"}]}], ")"}]}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"eqnB", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "\[Lambda]2Var"}], " ", "yVar"}], "-", 
         RowBox[{"m", 
          RowBox[{"(", 
           RowBox[{"yddot", "+", 
            RowBox[{"d2vdt2", "[", 
             RowBox[{"[", 
              RowBox[{"-", "1"}], "]"}], "]"}]}], ")"}]}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"eqnC", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "m"}], " ", "g"}], "-", 
         RowBox[{"\[Lambda]2Var", " ", "zVar"}], "-", 
         RowBox[{"m", " ", "zddot"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"eqnD", "=", 
        RowBox[{
         SuperscriptBox["xVar", "2"], "+", 
         SuperscriptBox["yVar", "2"], "+", 
         SuperscriptBox["zVar", "2"], "-", 
         SuperscriptBox["R", "2"]}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"goveqns", "=", 
        RowBox[{"Join", "[", 
         RowBox[{"eqnsU", ",", "eqnsV", ",", "eqns\[Lambda]", ",", 
          RowBox[{"{", 
           RowBox[{"eqnA", ",", "eqnB", ",", "eqnC", ",", "eqnD"}], "}"}]}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"allVars", "=", 
        RowBox[{"Join", "[", 
         RowBox[{"uGrid", ",", "vGrid", ",", "\[Lambda]Grid", ",", 
          RowBox[{"{", 
           RowBox[{"xVar", ",", "yVar", ",", "zVar", ",", "\[Lambda]2Var"}], 
           "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"vGuess", "=", 
        RowBox[{"initialV", "+", 
         RowBox[{"RandomReal", "[", 
          RowBox[{
           SuperscriptBox["10", 
            RowBox[{"-", "6"}]], ",", 
           RowBox[{"Length", "@", "initialV"}]}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"uGuess", "=", 
        RowBox[{"initialU", "+", 
         RowBox[{"RandomReal", "[", 
          RowBox[{
           SuperscriptBox["10", 
            RowBox[{"-", "6"}]], ",", 
           RowBox[{"Length", "@", "initialV"}]}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"\[Lambda]Guess", "=", 
        RowBox[{
         RowBox[{"\[Lambda]list", "[", 
          RowBox[{"[", 
           RowBox[{"-", "1"}], "]"}], "]"}], "+", 
         RowBox[{"RandomReal", "[", 
          RowBox[{
           SuperscriptBox["10", 
            RowBox[{"-", "6"}]], ",", 
           RowBox[{"Length", "@", "initialV"}]}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"\[Lambda]2Guess", "=", "Tsol"}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"xGuess", ",", "yGuess", ",", "zGuess"}], "}"}], "=", 
        RowBox[{"posbob", "+", 
         RowBox[{"velbob", " ", "dt"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"guess", "=", 
        RowBox[{"Join", "[", 
         RowBox[{"uGuess", ",", "vGuess", ",", "\[Lambda]Guess", ",", 
          RowBox[{"{", 
           RowBox[{
           "xGuess", ",", "yGuess", ",", "zGuess", ",", "\[Lambda]2Guess"}], 
           "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"fullsol", "=", 
        RowBox[{"allVars", "/.", 
         RowBox[{"FindRoot", "[", 
          RowBox[{"goveqns", ",", 
           RowBox[{"Transpose", "[", 
            RowBox[{"{", 
             RowBox[{"allVars", ",", "guess"}], "}"}], "]"}], ",", 
           RowBox[{"DampingFactor", "\[Rule]", "0.1"}], ",", 
           RowBox[{"MaxIterations", "\[Rule]", "10000"}]}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"xsol", ",", "ysol", ",", "zsol", ",", "Tsol"}], "}"}], "=", 
        RowBox[{"fullsol", "[", 
         RowBox[{"[", 
          RowBox[{
           RowBox[{"-", "4"}], ";;", 
           RowBox[{"-", "1"}]}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"fullsol", "=", 
        RowBox[{"Drop", "[", 
         RowBox[{"fullsol", ",", 
          RowBox[{"-", "4"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"usol", ",", "vsol", ",", "\[Lambda]sol"}], "}"}], "=", 
        RowBox[{"Partition", "[", 
         RowBox[{"fullsol", ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"Length", "@", "fullsol"}], ")"}], "/", "3"}]}], "]"}]}], 
       ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"uAcc", "=", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"usol", "-", 
              RowBox[{"(", 
               RowBox[{"initialU", "+", 
                RowBox[{"uVel", " ", "dt"}]}], ")"}]}], ")"}], "/", "dt"}], 
           "-", "uVel"}], ")"}], "/", "dt"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"vAcc", "=", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"vsol", "-", 
              RowBox[{"(", 
               RowBox[{"initialV", "+", 
                RowBox[{"vVel", " ", "dt"}]}], ")"}]}], ")"}], "/", "dt"}], 
           "-", "vVel"}], ")"}], "/", "dt"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"xAcc", "=", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"xsol", "-", 
              RowBox[{"(", 
               RowBox[{"xbob", "+", 
                RowBox[{"vx", " ", "dt"}]}], ")"}]}], ")"}], "/", "dt"}], "-",
            "vx"}], ")"}], "/", "dt"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"yAcc", "=", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"ysol", "-", 
              RowBox[{"(", 
               RowBox[{"ybob", "+", 
                RowBox[{"vy", " ", "dt"}]}], ")"}]}], ")"}], "/", "dt"}], "-",
            "vy"}], ")"}], "/", "dt"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"zAcc", "=", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"zsol", "-", 
              RowBox[{"(", 
               RowBox[{"zbob", "+", 
                RowBox[{"vz", " ", "dt"}]}], ")"}]}], ")"}], "/", "dt"}], "-",
            "vz"}], ")"}], "/", "dt"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"aBob", "=", 
        RowBox[{"{", 
         RowBox[{"xAcc", ",", "yAcc", ",", "zAcc"}], "}"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"t", "<", "dt"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"nearestPos", "=", 
           RowBox[{"NearestSphere", "[", 
            RowBox[{
             RowBox[{"posbob", "+", 
              RowBox[{"velbob", " ", "dt"}]}], ",", "R"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"vNew", "=", 
           RowBox[{"initialV", "+", 
            RowBox[{"vVel", " ", "dt"}]}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"uNew", "=", 
           RowBox[{"initialU", "+", 
            RowBox[{"uVel", " ", "dt"}]}]}], ";"}], "\[IndentingNewLine]", 
         ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"nearestPos", "=", 
           RowBox[{"NearestSphere", "[", 
            RowBox[{
             RowBox[{"posbob", "+", 
              RowBox[{
               RowBox[{"velboblist", "[", 
                RowBox[{"[", 
                 RowBox[{
                  RowBox[{"-", "2"}], ",", "2"}], "]"}], "]"}], "dt"}]}], ",",
              "R"}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"vNew", "=", 
           RowBox[{"initialV", "+", 
            RowBox[{
             RowBox[{"vVellist", "[", 
              RowBox[{"[", 
               RowBox[{"-", "1"}], "]"}], "]"}], " ", "dt"}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"uNew", "=", 
           RowBox[{"initialU", "+", 
            RowBox[{
             RowBox[{"uVellist", "[", 
              RowBox[{"[", 
               RowBox[{"-", "1"}], "]"}], "]"}], " ", "dt"}]}]}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"uNew", ",", "vNew", ",", 
         RowBox[{"uVel", "+", 
          RowBox[{"uAcc", " ", "dt"}]}], ",", 
         RowBox[{"vVel", "+", 
          RowBox[{"vAcc", " ", "dt"}]}], ",", "nearestPos", ",", 
         RowBox[{"velBob", "+", 
          RowBox[{"aBob", " ", "dt"}]}]}], "}"}]}]}], "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"LinearConstant\[Lambda]1", "=", 
    RowBox[{"Function", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "initialU", ",", "initialV", ",", "uVel", ",", "vVel", ",", "posbob", 
        ",", "velbob", ",", "dt"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"d4fds4", "=", 
        RowBox[{
         RowBox[{"NDSolve`FiniteDifferenceDerivative", "[", 
          RowBox[{"4", ",", "sGrid", ",", "opt"}], "]"}], "[", 
         "\"\<DifferentiationMatrix\>\"", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"d3fds3", "=", 
        RowBox[{
         RowBox[{"NDSolve`FiniteDifferenceDerivative", "[", 
          RowBox[{"3", ",", "sGrid", ",", "opt"}], "]"}], "[", 
         "\"\<DifferentiationMatrix\>\"", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"d2fds2", "=", 
        RowBox[{
         RowBox[{"NDSolve`FiniteDifferenceDerivative", "[", 
          RowBox[{"2", ",", "sGrid", ",", "opt"}], "]"}], "[", 
         "\"\<DifferentiationMatrix\>\"", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"dfds", "=", 
        RowBox[{
         RowBox[{"NDSolve`FiniteDifferenceDerivative", "[", 
          RowBox[{"1", ",", "sGrid", ",", "opt"}], "]"}], "[", 
         "\"\<DifferentiationMatrix\>\"", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"d4vds4", "=", 
        RowBox[{"d4fds4", ".", "vGrid"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"d3vds3", "=", 
        RowBox[{"d3fds3", ".", "vGrid"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"d2vds2", "=", 
        RowBox[{"d2fds2", ".", "vGrid"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"dvds", "=", 
        RowBox[{"dfds", ".", "vGrid"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"xbob", ",", "ybob", ",", "zbob"}], "}"}], "=", "posbob"}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"vx", ",", "vy", ",", "vz"}], "}"}], "=", "velbob"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"xVar", "=", 
        RowBox[{"Unique", "[", "\"\<xbob\>\"", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"yVar", "=", 
        RowBox[{"Unique", "[", "\"\<ybob\>\"", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"zVar", "=", 
        RowBox[{"Unique", "[", "\"\<zbob\>\"", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"\[Lambda]2Var", "=", 
        RowBox[{"Unique", "[", "\"\<\[Lambda]2\>\"", "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"vdot", "=", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"vGrid", "-", 
           RowBox[{"(", 
            RowBox[{"initialV", "+", 
             RowBox[{"vVel", " ", "dt"}]}], ")"}]}], ")"}], "/", "dt"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"xdot", "=", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"xVar", "-", 
           RowBox[{"(", 
            RowBox[{"xbob", "+", 
             RowBox[{"vx", " ", "dt"}]}], ")"}]}], ")"}], "/", "dt"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"ydot", "=", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"yVar", "-", 
           RowBox[{"(", 
            RowBox[{"ybob", "+", 
             RowBox[{"vy", " ", "dt"}]}], ")"}]}], ")"}], "/", "dt"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"zdot", "=", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"zVar", "-", 
           RowBox[{"(", 
            RowBox[{"zbob", "+", 
             RowBox[{"vz", " ", "dt"}]}], ")"}]}], ")"}], "/", "dt"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"d2vdt2", "=", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"vdot", "-", "vVel"}], ")"}], "/", "dt"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"xddot", "=", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"xdot", "-", "vx"}], ")"}], "/", "dt"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"yddot", "=", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"ydot", "-", "vy"}], ")"}], "/", "dt"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"zddot", "=", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"zdot", "-", "vz"}], ")"}], "/", "dt"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"duds", "=", 
        RowBox[{
         RowBox[{"Sqrt", "[", 
          RowBox[{"1", "-", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"dfds", ".", "vGrid"}], ")"}], "^", "2"}]}], "]"}], "-", 
         "1"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"uEnd", "=", 
        RowBox[{
         RowBox[{"Total", "[", "duds", "]"}], "ds"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"d2udt2End", "=", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"uEnd", "-", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"initialU", "+", 
                 RowBox[{"uVel", " ", "dt"}]}], ")"}], "[", 
               RowBox[{"[", 
                RowBox[{"-", "1"}], "]"}], "]"}]}], ")"}], "/", "dt"}], "-", 
           RowBox[{"uVel", "[", 
            RowBox[{"[", 
             RowBox[{"-", "1"}], "]"}], "]"}]}], ")"}], "/", "dt"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"\[Lambda]", "=", 
        RowBox[{"\[Lambda]2Var", " ", "xVar"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"eqnsV", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "\[Mu]"}], " ", "d2vdt2"}], "+", 
         RowBox[{"\[Lambda]", " ", "d2vds2"}], "-", 
         RowBox[{"EI", " ", "d4vds4"}]}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"yForce", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "\[Lambda]"}], " ", "dvds"}], "+", 
         RowBox[{"EI", " ", "d3vds3"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"eqnsV", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "=", 
        RowBox[{"vGrid", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"eqnsV", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "=", 
        RowBox[{"dvds", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"eqnsV", "[", 
         RowBox[{"[", 
          RowBox[{"-", "1"}], "]"}], "]"}], "=", 
        RowBox[{
         RowBox[{"yForce", "[", 
          RowBox[{"[", 
           RowBox[{"-", "1"}], "]"}], "]"}], "+", 
         RowBox[{"\[Lambda]2Var", " ", "yVar"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"eqnsV", "[", 
         RowBox[{"[", 
          RowBox[{"-", "2"}], "]"}], "]"}], "=", 
        RowBox[{"d2vds2", "[", 
         RowBox[{"[", 
          RowBox[{"-", "1"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"eqnA", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "\[Lambda]2Var"}], " ", "xVar"}], "-", 
         RowBox[{"m", 
          RowBox[{"(", 
           RowBox[{"xddot", "+", "d2udt2End"}], ")"}]}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"eqnB", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "\[Lambda]2Var"}], " ", "yVar"}], "-", 
         RowBox[{"m", 
          RowBox[{"(", 
           RowBox[{"yddot", "+", 
            RowBox[{"d2vdt2", "[", 
             RowBox[{"[", 
              RowBox[{"-", "1"}], "]"}], "]"}]}], ")"}]}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"eqnC", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "m"}], " ", "g"}], "-", 
         RowBox[{"\[Lambda]2Var", " ", "zVar"}], "-", 
         RowBox[{"m", " ", "zddot"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"eqnD", "=", 
        RowBox[{
         SuperscriptBox["xVar", "2"], "+", 
         SuperscriptBox["yVar", "2"], "+", 
         SuperscriptBox["zVar", "2"], "-", 
         SuperscriptBox["R", "2"]}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"goveqns", "=", 
        RowBox[{"Join", "[", 
         RowBox[{"eqnsV", ",", 
          RowBox[{"{", 
           RowBox[{"eqnA", ",", "eqnB", ",", "eqnC", ",", "eqnD"}], "}"}]}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"allVars", "=", 
        RowBox[{"Join", "[", 
         RowBox[{"vGrid", ",", 
          RowBox[{"{", 
           RowBox[{"xVar", ",", "yVar", ",", "zVar", ",", "\[Lambda]2Var"}], 
           "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"vGuess", "=", 
        RowBox[{"initialV", "+", 
         RowBox[{"RandomReal", "[", 
          RowBox[{
           SuperscriptBox["10", 
            RowBox[{"-", "6"}]], ",", 
           RowBox[{"Length", "@", "initialV"}]}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"\[Lambda]2Guess", "=", "Tsol"}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"xGuess", ",", "yGuess", ",", "zGuess"}], "}"}], "=", 
        RowBox[{"posbob", "+", 
         RowBox[{"velbob", " ", "dt"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"guess", "=", 
        RowBox[{"Join", "[", 
         RowBox[{"vGuess", ",", 
          RowBox[{"{", 
           RowBox[{
           "xGuess", ",", "yGuess", ",", "zGuess", ",", "\[Lambda]2Guess"}], 
           "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"fullsol", "=", 
        RowBox[{"allVars", "/.", 
         RowBox[{"FindRoot", "[", 
          RowBox[{"goveqns", ",", 
           RowBox[{"Transpose", "[", 
            RowBox[{"{", 
             RowBox[{"allVars", ",", "guess"}], "}"}], "]"}], ",", 
           RowBox[{"DampingFactor", "\[Rule]", "1"}], ",", 
           RowBox[{"MaxIterations", "\[Rule]", "10000"}]}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"xsol", ",", "ysol", ",", "zsol", ",", "Tsol"}], "}"}], "=", 
        RowBox[{"fullsol", "[", 
         RowBox[{"[", 
          RowBox[{
           RowBox[{"-", "4"}], ";;", 
           RowBox[{"-", "1"}]}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"vsol", "=", 
        RowBox[{"Drop", "[", 
         RowBox[{"fullsol", ",", 
          RowBox[{"-", "4"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"duds", "=", 
        RowBox[{
         RowBox[{"Sqrt", "[", 
          RowBox[{"1", "-", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"dfds", ".", "vsol"}], ")"}], "^", "2"}]}], "]"}], "-", 
         "1"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"usol", "=", 
        RowBox[{"ds", " ", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"Total", "[", 
            RowBox[{"duds", "[", 
             RowBox[{"[", 
              RowBox[{"1", ";;", "i"}], "]"}], "]"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", 
             RowBox[{"Length", "@", "duds"}], ",", "1"}], "}"}]}], "]"}]}]}], 
       ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"uAcc", "=", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"usol", "-", 
              RowBox[{"(", 
               RowBox[{"initialU", "+", 
                RowBox[{"uVel", " ", "dt"}]}], ")"}]}], ")"}], "/", "dt"}], 
           "-", "uVel"}], ")"}], "/", "dt"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"vAcc", "=", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"vsol", "-", 
              RowBox[{"(", 
               RowBox[{"initialV", "+", 
                RowBox[{"vVel", " ", "dt"}]}], ")"}]}], ")"}], "/", "dt"}], 
           "-", "vVel"}], ")"}], "/", "dt"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"xAcc", "=", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"xsol", "-", 
              RowBox[{"(", 
               RowBox[{"xbob", "+", 
                RowBox[{"vx", " ", "dt"}]}], ")"}]}], ")"}], "/", "dt"}], "-",
            "vx"}], ")"}], "/", "dt"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"yAcc", "=", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"ysol", "-", 
              RowBox[{"(", 
               RowBox[{"ybob", "+", 
                RowBox[{"vy", " ", "dt"}]}], ")"}]}], ")"}], "/", "dt"}], "-",
            "vy"}], ")"}], "/", "dt"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"zAcc", "=", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"zsol", "-", 
              RowBox[{"(", 
               RowBox[{"zbob", "+", 
                RowBox[{"vz", " ", "dt"}]}], ")"}]}], ")"}], "/", "dt"}], "-",
            "vz"}], ")"}], "/", "dt"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"aBob", "=", 
        RowBox[{"{", 
         RowBox[{"xAcc", ",", "yAcc", ",", "zAcc"}], "}"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"t", "<", "dt"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"nearestPos", "=", 
           RowBox[{"NearestSphere", "[", 
            RowBox[{
             RowBox[{"posbob", "+", 
              RowBox[{"velbob", " ", "dt"}]}], ",", "R"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"vNew", "=", 
           RowBox[{"initialV", "+", 
            RowBox[{"vVel", " ", "dt"}]}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"uNew", "=", 
           RowBox[{"initialU", "+", 
            RowBox[{"uVel", " ", "dt"}]}]}], ";"}], "\[IndentingNewLine]", 
         ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"nearestPos", "=", 
           RowBox[{"NearestSphere", "[", 
            RowBox[{
             RowBox[{"posbob", "+", 
              RowBox[{
               RowBox[{"velboblist", "[", 
                RowBox[{"[", 
                 RowBox[{
                  RowBox[{"-", "2"}], ",", "2"}], "]"}], "]"}], "dt"}]}], ",",
              "R"}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"vNew", "=", 
           RowBox[{"initialV", "+", 
            RowBox[{
             RowBox[{"vVellist", "[", 
              RowBox[{"[", 
               RowBox[{"-", "1"}], "]"}], "]"}], " ", "dt"}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"uNew", "=", 
           RowBox[{"initialU", "+", 
            RowBox[{
             RowBox[{"uVellist", "[", 
              RowBox[{"[", 
               RowBox[{"-", "1"}], "]"}], "]"}], " ", "dt"}]}]}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"uNew", ",", "vNew", ",", 
         RowBox[{"uVel", "+", 
          RowBox[{"uAcc", " ", "dt"}]}], ",", 
         RowBox[{"vVel", "+", 
          RowBox[{"vAcc", " ", "dt"}]}], ",", "nearestPos", ",", 
         RowBox[{"velBob", "+", 
          RowBox[{"aBob", " ", "dt"}]}]}], "}"}]}]}], "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"NonLinearConstant\[Lambda]1ExtraString", "=", 
    RowBox[{"Function", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "initialU", ",", "initialV", ",", "uVel", ",", "vVel", ",", "posbob", 
        ",", "velbob", ",", "dt"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"\[Alpha]angle", "=", 
        RowBox[{
         RowBox[{"45", " ", "Degree"}], "//", "N"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"d4fds4", "=", 
        RowBox[{
         RowBox[{"NDSolve`FiniteDifferenceDerivative", "[", 
          RowBox[{"4", ",", "sGrid", ",", "opt"}], "]"}], "[", 
         "\"\<DifferentiationMatrix\>\"", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"d3fds3", "=", 
        RowBox[{
         RowBox[{"NDSolve`FiniteDifferenceDerivative", "[", 
          RowBox[{"3", ",", "sGrid", ",", "opt"}], "]"}], "[", 
         "\"\<DifferentiationMatrix\>\"", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"d2fds2", "=", 
        RowBox[{
         RowBox[{"NDSolve`FiniteDifferenceDerivative", "[", 
          RowBox[{"2", ",", "sGrid", ",", "opt"}], "]"}], "[", 
         "\"\<DifferentiationMatrix\>\"", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"dfds", "=", 
        RowBox[{
         RowBox[{"NDSolve`FiniteDifferenceDerivative", "[", 
          RowBox[{"1", ",", "sGrid", ",", "opt"}], "]"}], "[", 
         "\"\<DifferentiationMatrix\>\"", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"d4vds4", "=", 
        RowBox[{"d4fds4", ".", "vGrid"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"d3vds3", "=", 
        RowBox[{"d3fds3", ".", "vGrid"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"d2vds2", "=", 
        RowBox[{"d2fds2", ".", "vGrid"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"dvds", "=", 
        RowBox[{"dfds", ".", "vGrid"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"xbob", ",", "ybob", ",", "zbob"}], "}"}], "=", "posbob"}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"vx", ",", "vy", ",", "vz"}], "}"}], "=", "velbob"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"xVar", "=", 
        RowBox[{"Unique", "[", "\"\<xbob\>\"", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"yVar", "=", 
        RowBox[{"Unique", "[", "\"\<ybob\>\"", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"zVar", "=", 
        RowBox[{"Unique", "[", "\"\<zbob\>\"", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"\[Lambda]2Var", "=", 
        RowBox[{"Unique", "[", "\"\<\[Lambda]2\>\"", "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"vdot", "=", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"vGrid", "-", 
           RowBox[{"(", 
            RowBox[{"initialV", "+", 
             RowBox[{"vVel", " ", "dt"}]}], ")"}]}], ")"}], "/", "dt"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"xdot", "=", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"xVar", "-", 
           RowBox[{"(", 
            RowBox[{"xbob", "+", 
             RowBox[{"vx", " ", "dt"}]}], ")"}]}], ")"}], "/", "dt"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"ydot", "=", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"yVar", "-", 
           RowBox[{"(", 
            RowBox[{"ybob", "+", 
             RowBox[{"vy", " ", "dt"}]}], ")"}]}], ")"}], "/", "dt"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"zdot", "=", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"zVar", "-", 
           RowBox[{"(", 
            RowBox[{"zbob", "+", 
             RowBox[{"vz", " ", "dt"}]}], ")"}]}], ")"}], "/", "dt"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"d2vdt2", "=", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"vdot", "-", "vVel"}], ")"}], "/", "dt"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"xddot", "=", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"xdot", "-", "vx"}], ")"}], "/", "dt"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"yddot", "=", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"ydot", "-", "vy"}], ")"}], "/", "dt"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"zddot", "=", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"zdot", "-", "vz"}], ")"}], "/", "dt"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"duds", "=", 
        RowBox[{
         RowBox[{"Sqrt", "[", 
          RowBox[{"1", "-", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"dfds", ".", "vGrid"}], ")"}], "^", "2"}]}], "]"}], "-", 
         "1"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"uEnd", "=", 
        RowBox[{
         RowBox[{"Total", "[", "duds", "]"}], "ds"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"d2udt2End", "=", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"uEnd", "-", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"initialU", "+", 
                 RowBox[{"uVel", " ", "dt"}]}], ")"}], "[", 
               RowBox[{"[", 
                RowBox[{"-", "1"}], "]"}], "]"}]}], ")"}], "/", "dt"}], "-", 
           RowBox[{"uVel", "[", 
            RowBox[{"[", 
             RowBox[{"-", "1"}], "]"}], "]"}]}], ")"}], "/", "dt"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"T2", "=", 
        RowBox[{"\[Lambda]2Var", " ", 
         RowBox[{"zVar", "/", 
          RowBox[{"Sin", "[", "\[Alpha]angle", "]"}]}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"\[Beta]", "=", 
          RowBox[{"ArcTan", "[", 
           FractionBox[
            RowBox[{"vGrid", "[", 
             RowBox[{"[", 
              RowBox[{"-", "1"}], "]"}], "]"}], 
            RowBox[{"l", "+", "uEnd"}]], "]"}]}], ";"}], "*)"}], 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"\[Lambda]", "=", 
        RowBox[{
         RowBox[{"\[Lambda]2Var", " ", "xVar"}], "-", 
         RowBox[{"T2", " ", 
          RowBox[{"Cos", "[", "\[Alpha]angle", "]"}]}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"force", "=", 
        RowBox[{
         RowBox[{"\[Lambda]2Var", " ", "yVar"}], "-", 
         RowBox[{"T2", " ", 
          RowBox[{"Cos", "[", "\[Alpha]angle", "]"}], "*", 
          FractionBox[
           RowBox[{"vGrid", "[", 
            RowBox[{"[", 
             RowBox[{"-", "1"}], "]"}], "]"}], "l"]}]}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"lazy1", "=", 
        RowBox[{"(", 
         RowBox[{"1", "-", 
          RowBox[{"3.", "dvds"}], "+", 
          RowBox[{"3.", 
           RowBox[{
            RowBox[{"dvds", "^", "2"}], "/", "2"}]}], "-", 
          RowBox[{"6.", 
           RowBox[{"dvds", "^", "3"}]}], "-", 
          RowBox[{"9.", 
           RowBox[{
            RowBox[{"dvds", "^", "5"}], "/", "4"}]}]}], ")"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"lazy2", "=", 
        RowBox[{"3.", 
         RowBox[{"(", 
          RowBox[{"dvds", "-", "1.", "-", 
           RowBox[{"6.", 
            RowBox[{"dvds", "^", "2"}]}], "-", 
           RowBox[{"15.", 
            RowBox[{
             RowBox[{"dvds", "^", "4"}], "/", "4"}]}]}], ")"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"eqnsV", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "\[Mu]"}], " ", "d2vdt2"}], "+", 
         RowBox[{"\[Lambda]", " ", "d2vds2"}], "-", 
         RowBox[{"cDamping", " ", "vdot"}], "+", 
         RowBox[{"dfds", ".", 
          RowBox[{"(", 
           RowBox[{"EI", " ", 
            RowBox[{"d2vds2", "^", "2"}], " ", "lazy1", " ", "lazy2"}], 
           ")"}]}], "-", 
         RowBox[{"EI", " ", 
          RowBox[{"d2fds2", ".", 
           RowBox[{"(", 
            RowBox[{"d2vds2", " ", 
             RowBox[{"lazy1", "^", "2"}]}], ")"}]}]}]}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"yForce", "=", 
        RowBox[{
         RowBox[{"EI", " ", 
          RowBox[{"dfds", ".", 
           RowBox[{"(", 
            RowBox[{"d2vds2", " ", 
             RowBox[{"lazy1", "^", "2"}]}], ")"}]}]}], "-", 
         RowBox[{"\[Lambda]", " ", "dvds"}], "-", 
         RowBox[{"EI", " ", 
          RowBox[{"d2vds2", "^", "2"}], " ", "lazy1", " ", "lazy2"}]}]}], ";",
        "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"eqnsV", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "=", 
        RowBox[{"vGrid", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"eqnsV", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "=", 
        RowBox[{"dvds", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"eqnsV", "[", 
         RowBox[{"[", 
          RowBox[{"-", "1"}], "]"}], "]"}], "=", 
        RowBox[{
         RowBox[{"yForce", "[", 
          RowBox[{"[", 
           RowBox[{"-", "1"}], "]"}], "]"}], "+", "force"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"eqnsV", "[", 
         RowBox[{"[", 
          RowBox[{"-", "2"}], "]"}], "]"}], "=", 
        RowBox[{"d2vds2", "[", 
         RowBox[{"[", 
          RowBox[{"-", "1"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"eqnA", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "\[Lambda]2Var"}], " ", "xVar"}], "-", 
         RowBox[{"m", 
          RowBox[{"(", 
           RowBox[{"xddot", "+", "d2udt2End"}], ")"}]}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"eqnB", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "\[Lambda]2Var"}], " ", "yVar"}], "-", 
         RowBox[{"m", 
          RowBox[{"(", 
           RowBox[{"yddot", "+", 
            RowBox[{"d2vdt2", "[", 
             RowBox[{"[", 
              RowBox[{"-", "1"}], "]"}], "]"}]}], ")"}]}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"eqnC", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "m"}], " ", "g"}], "-", 
         RowBox[{"\[Lambda]2Var", " ", "zVar"}], "-", 
         RowBox[{"m", " ", "zddot"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"eqnD", "=", 
        RowBox[{
         SuperscriptBox["xVar", "2"], "+", 
         SuperscriptBox["yVar", "2"], "+", 
         SuperscriptBox["zVar", "2"], "-", 
         SuperscriptBox["R", "2"]}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"goveqns", "=", 
        RowBox[{"Join", "[", 
         RowBox[{"eqnsV", ",", 
          RowBox[{"{", 
           RowBox[{"eqnA", ",", "eqnB", ",", "eqnC", ",", "eqnD"}], "}"}]}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"allVars", "=", 
        RowBox[{"Join", "[", 
         RowBox[{"vGrid", ",", 
          RowBox[{"{", 
           RowBox[{"xVar", ",", "yVar", ",", "zVar", ",", "\[Lambda]2Var"}], 
           "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"vGuess", "=", 
        RowBox[{"initialV", "+", 
         RowBox[{"ConstantArray", "[", 
          RowBox[{
           RowBox[{"RandomReal", "[", 
            SuperscriptBox["10", 
             RowBox[{"-", "1"}]], "]"}], ",", 
           RowBox[{"Length", "@", "initialV"}]}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"\[Lambda]2Guess", "=", "Tsol"}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"xGuess", ",", "yGuess", ",", "zGuess"}], "}"}], "=", 
        RowBox[{"posbob", "+", 
         RowBox[{"velbob", " ", "dt"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"guess", "=", 
        RowBox[{"Join", "[", 
         RowBox[{"vGuess", ",", 
          RowBox[{"{", 
           RowBox[{
           "xGuess", ",", "yGuess", ",", "zGuess", ",", "\[Lambda]2Guess"}], 
           "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"fullsol", "=", 
        RowBox[{"allVars", "/.", 
         RowBox[{"FindRoot", "[", 
          RowBox[{"goveqns", ",", 
           RowBox[{"Transpose", "[", 
            RowBox[{"{", 
             RowBox[{"allVars", ",", "guess"}], "}"}], "]"}], ",", 
           RowBox[{"DampingFactor", "\[Rule]", "1"}], ",", 
           RowBox[{"MaxIterations", "\[Rule]", "10000"}]}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"xsol", ",", "ysol", ",", "zsol", ",", "Tsol"}], "}"}], "=", 
        RowBox[{"fullsol", "[", 
         RowBox[{"[", 
          RowBox[{
           RowBox[{"-", "4"}], ";;", 
           RowBox[{"-", "1"}]}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"vsol", "=", 
        RowBox[{"Drop", "[", 
         RowBox[{"fullsol", ",", 
          RowBox[{"-", "4"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"duds", "=", 
        RowBox[{
         RowBox[{"Sqrt", "[", 
          RowBox[{"1", "-", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"dfds", ".", "vsol"}], ")"}], "^", "2"}]}], "]"}], "-", 
         "1"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"usol", "=", 
        RowBox[{"ds", " ", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"Total", "[", 
            RowBox[{"duds", "[", 
             RowBox[{"[", 
              RowBox[{"1", ";;", "i"}], "]"}], "]"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", 
             RowBox[{"Length", "@", "duds"}], ",", "1"}], "}"}]}], "]"}]}]}], 
       ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"uAcc", "=", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"usol", "-", 
              RowBox[{"(", 
               RowBox[{"initialU", "+", 
                RowBox[{"uVel", " ", "dt"}]}], ")"}]}], ")"}], "/", "dt"}], 
           "-", "uVel"}], ")"}], "/", "dt"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"vAcc", "=", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"vsol", "-", 
              RowBox[{"(", 
               RowBox[{"initialV", "+", 
                RowBox[{"vVel", " ", "dt"}]}], ")"}]}], ")"}], "/", "dt"}], 
           "-", "vVel"}], ")"}], "/", "dt"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"xAcc", "=", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"xsol", "-", 
              RowBox[{"(", 
               RowBox[{"xbob", "+", 
                RowBox[{"vx", " ", "dt"}]}], ")"}]}], ")"}], "/", "dt"}], "-",
            "vx"}], ")"}], "/", "dt"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"yAcc", "=", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"ysol", "-", 
              RowBox[{"(", 
               RowBox[{"ybob", "+", 
                RowBox[{"vy", " ", "dt"}]}], ")"}]}], ")"}], "/", "dt"}], "-",
            "vy"}], ")"}], "/", "dt"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"zAcc", "=", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"zsol", "-", 
              RowBox[{"(", 
               RowBox[{"zbob", "+", 
                RowBox[{"vz", " ", "dt"}]}], ")"}]}], ")"}], "/", "dt"}], "-",
            "vz"}], ")"}], "/", "dt"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"aBob", "=", 
        RowBox[{"{", 
         RowBox[{"xAcc", ",", "yAcc", ",", "zAcc"}], "}"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"t", "<", "dt"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"nearestPos", "=", 
           RowBox[{"NearestSphere", "[", 
            RowBox[{
             RowBox[{"posbob", "+", 
              RowBox[{"velbob", " ", "dt"}]}], ",", "R"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"vNew", "=", 
           RowBox[{"initialV", "+", 
            RowBox[{"vVel", " ", "dt"}]}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"uNew", "=", 
           RowBox[{"initialU", "+", 
            RowBox[{"uVel", " ", "dt"}]}]}], ";"}], "\[IndentingNewLine]", 
         ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"nearestPos", "=", 
           RowBox[{"NearestSphere", "[", 
            RowBox[{
             RowBox[{"posbob", "+", 
              RowBox[{
               RowBox[{"velboblist", "[", 
                RowBox[{"[", 
                 RowBox[{
                  RowBox[{"-", "2"}], ",", "2"}], "]"}], "]"}], "dt"}]}], ",",
              "R"}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"vNew", "=", 
           RowBox[{"initialV", "+", 
            RowBox[{
             RowBox[{"vVellist", "[", 
              RowBox[{"[", 
               RowBox[{"-", "1"}], "]"}], "]"}], " ", "dt"}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"uNew", "=", 
           RowBox[{"initialU", "+", 
            RowBox[{
             RowBox[{"uVellist", "[", 
              RowBox[{"[", 
               RowBox[{"-", "1"}], "]"}], "]"}], " ", "dt"}]}]}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"uNew", ",", "vNew", ",", 
         RowBox[{"uVel", "+", 
          RowBox[{"uAcc", " ", "dt"}]}], ",", 
         RowBox[{"vVel", "+", 
          RowBox[{"vAcc", " ", "dt"}]}], ",", "nearestPos", ",", 
         RowBox[{"velBob", "+", 
          RowBox[{"aBob", " ", "dt"}]}]}], "}"}]}]}], "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"LinearConstant\[Lambda]1ExtraString", "=", 
   RowBox[{"Function", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "initialU", ",", "initialV", ",", "uVel", ",", "vVel", ",", "posbob", 
       ",", "velbob", ",", "dt"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"d4fds4", "=", 
       RowBox[{
        RowBox[{"NDSolve`FiniteDifferenceDerivative", "[", 
         RowBox[{"4", ",", "sGrid", ",", "opt"}], "]"}], "[", 
        "\"\<DifferentiationMatrix\>\"", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"d3fds3", "=", 
       RowBox[{
        RowBox[{"NDSolve`FiniteDifferenceDerivative", "[", 
         RowBox[{"3", ",", "sGrid", ",", "opt"}], "]"}], "[", 
        "\"\<DifferentiationMatrix\>\"", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"d2fds2", "=", 
       RowBox[{
        RowBox[{"NDSolve`FiniteDifferenceDerivative", "[", 
         RowBox[{"2", ",", "sGrid", ",", "opt"}], "]"}], "[", 
        "\"\<DifferentiationMatrix\>\"", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"dfds", "=", 
       RowBox[{
        RowBox[{"NDSolve`FiniteDifferenceDerivative", "[", 
         RowBox[{"1", ",", "sGrid", ",", "opt"}], "]"}], "[", 
        "\"\<DifferentiationMatrix\>\"", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"d4vds4", "=", 
       RowBox[{"d4fds4", ".", "vGrid"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"d3vds3", "=", 
       RowBox[{"d3fds3", ".", "vGrid"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"d2vds2", "=", 
       RowBox[{"d2fds2", ".", "vGrid"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"dvds", "=", 
       RowBox[{"dfds", ".", "vGrid"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"xbob", ",", "ybob", ",", "zbob"}], "}"}], "=", "posbob"}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"vx", ",", "vy", ",", "vz"}], "}"}], "=", "velbob"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"xVar", "=", 
       RowBox[{"Unique", "[", "\"\<xbob\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"yVar", "=", 
       RowBox[{"Unique", "[", "\"\<ybob\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"zVar", "=", 
       RowBox[{"Unique", "[", "\"\<zbob\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Lambda]2Var", "=", 
       RowBox[{"Unique", "[", "\"\<\[Lambda]2\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"vdot", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"vGrid", "-", 
          RowBox[{"(", 
           RowBox[{"initialV", "+", 
            RowBox[{"vVel", " ", "dt"}]}], ")"}]}], ")"}], "/", "dt"}]}], ";",
       "\[IndentingNewLine]", 
      RowBox[{"xdot", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"xVar", "-", 
          RowBox[{"(", 
           RowBox[{"xbob", "+", 
            RowBox[{"vx", " ", "dt"}]}], ")"}]}], ")"}], "/", "dt"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ydot", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"yVar", "-", 
          RowBox[{"(", 
           RowBox[{"ybob", "+", 
            RowBox[{"vy", " ", "dt"}]}], ")"}]}], ")"}], "/", "dt"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"zdot", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"zVar", "-", 
          RowBox[{"(", 
           RowBox[{"zbob", "+", 
            RowBox[{"vz", " ", "dt"}]}], ")"}]}], ")"}], "/", "dt"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"d2vdt2", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"vdot", "-", "vVel"}], ")"}], "/", "dt"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"xddot", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"xdot", "-", "vx"}], ")"}], "/", "dt"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"yddot", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"ydot", "-", "vy"}], ")"}], "/", "dt"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"zddot", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"zdot", "-", "vz"}], ")"}], "/", "dt"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"duds", "=", 
       RowBox[{
        RowBox[{"Sqrt", "[", 
         RowBox[{"1", "-", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"dfds", ".", "vGrid"}], ")"}], "^", "2"}]}], "]"}], "-", 
        "1"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"uEnd", "=", 
       RowBox[{
        RowBox[{"Total", "[", "duds", "]"}], "ds"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"d2udt2End", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"uEnd", "-", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"initialU", "+", 
                RowBox[{"uVel", " ", "dt"}]}], ")"}], "[", 
              RowBox[{"[", 
               RowBox[{"-", "1"}], "]"}], "]"}]}], ")"}], "/", "dt"}], "-", 
          RowBox[{"uVel", "[", 
           RowBox[{"[", 
            RowBox[{"-", "1"}], "]"}], "]"}]}], ")"}], "/", "dt"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"T2", "=", 
       RowBox[{
        RowBox[{"-", "\[Lambda]2Var"}], " ", 
        RowBox[{"zVar", "/", 
         RowBox[{"Sin", "[", "\[Alpha]angle", "]"}]}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"\[Beta]", "=", 
         RowBox[{"ArcTan", "[", 
          FractionBox[
           RowBox[{"vGrid", "[", 
            RowBox[{"[", 
             RowBox[{"-", "1"}], "]"}], "]"}], 
           RowBox[{"l", "+", "uEnd"}]], "]"}]}], ";"}], "*)"}], 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"\[Lambda]", "=", 
       RowBox[{
        RowBox[{"\[Lambda]2Var", " ", "xVar"}], "-", 
        RowBox[{"T2", " ", 
         RowBox[{"Cos", "[", "\[Alpha]angle", "]"}]}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"force", "=", 
       RowBox[{
        RowBox[{"\[Lambda]2Var", " ", "yVar"}], "-", 
        RowBox[{"T2", " ", 
         RowBox[{"Cos", "[", "\[Alpha]angle", "]"}], "*", 
         FractionBox[
          RowBox[{"vGrid", "[", 
           RowBox[{"[", 
            RowBox[{"-", "1"}], "]"}], "]"}], "l"]}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"eqnsV", "=", 
       RowBox[{
        RowBox[{"\[Mu]", " ", "d2vdt2"}], "-", 
        RowBox[{"\[Lambda]", " ", "d2vds2"}], "+", 
        RowBox[{"EI", " ", "d4vds4"}], "+", 
        RowBox[{"cDamping", " ", "vdot"}]}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"yForce", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "\[Lambda]"}], " ", "dvds"}], "+", 
        RowBox[{"EI", " ", "d3vds3"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"eqnsV", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "=", 
       RowBox[{"vGrid", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"eqnsV", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "=", 
       RowBox[{"dvds", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"eqnsV", "[", 
        RowBox[{"[", 
         RowBox[{"-", "1"}], "]"}], "]"}], "=", 
       RowBox[{
        RowBox[{"yForce", "[", 
         RowBox[{"[", 
          RowBox[{"-", "1"}], "]"}], "]"}], "+", "force"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"eqnsV", "[", 
        RowBox[{"[", 
         RowBox[{"-", "2"}], "]"}], "]"}], "=", 
       RowBox[{"d2vds2", "[", 
        RowBox[{"[", 
         RowBox[{"-", "1"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"eqnA", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "\[Lambda]2Var"}], " ", "xVar"}], "-", 
        RowBox[{"m", 
         RowBox[{"(", 
          RowBox[{"xddot", "+", "d2udt2End"}], ")"}]}], "-", 
        RowBox[{"k1", " ", "xdot"}], "-", 
        RowBox[{"k2", " ", 
         RowBox[{"xdot", "^", "2"}], " ", 
         RowBox[{"Sign", "[", "xdot", "]"}]}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"eqnB", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "\[Lambda]2Var"}], " ", "yVar"}], "-", 
        RowBox[{"m", 
         RowBox[{"(", 
          RowBox[{"yddot", "+", 
           RowBox[{"d2vdt2", "[", 
            RowBox[{"[", 
             RowBox[{"-", "1"}], "]"}], "]"}]}], ")"}]}], "-", 
        RowBox[{"k1", " ", "ydot"}], "-", 
        RowBox[{"k2", " ", 
         RowBox[{"ydot", "^", "2"}], " ", 
         RowBox[{"Sign", "[", "ydot", "]"}]}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"eqnC", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "m"}], " ", "g"}], "-", 
        RowBox[{"\[Lambda]2Var", " ", "zVar"}], "-", 
        RowBox[{"m", " ", "zddot"}], "-", 
        RowBox[{"k1", " ", "zdot"}], "-", 
        RowBox[{"k2", " ", 
         RowBox[{"zdot", "^", "2"}], " ", 
         RowBox[{"Sign", "[", "zdot", "]"}]}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"eqnD", "=", 
       RowBox[{
        SuperscriptBox["xVar", "2"], "+", 
        SuperscriptBox["yVar", "2"], "+", 
        SuperscriptBox["zVar", "2"], "-", 
        SuperscriptBox["R", "2"]}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"goveqns", "=", 
       RowBox[{"Join", "[", 
        RowBox[{"eqnsV", ",", 
         RowBox[{"{", 
          RowBox[{"eqnA", ",", "eqnB", ",", "eqnC", ",", "eqnD"}], "}"}]}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"allVars", "=", 
       RowBox[{"Join", "[", 
        RowBox[{"vGrid", ",", 
         RowBox[{"{", 
          RowBox[{"xVar", ",", "yVar", ",", "zVar", ",", "\[Lambda]2Var"}], 
          "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"vGuess", "=", 
       RowBox[{"initialV", "+", 
        RowBox[{"ConstantArray", "[", 
         RowBox[{
          RowBox[{"RandomReal", "[", 
           SuperscriptBox["10", 
            RowBox[{"-", "1"}]], "]"}], ",", 
          RowBox[{"Length", "@", "initialV"}]}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Lambda]2Guess", "=", "Tsol"}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"xGuess", ",", "yGuess", ",", "zGuess"}], "}"}], "=", 
       RowBox[{"posbob", "+", 
        RowBox[{"velbob", " ", "dt"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"guess", "=", 
       RowBox[{"Join", "[", 
        RowBox[{"vGuess", ",", 
         RowBox[{"{", 
          RowBox[{
          "xGuess", ",", "yGuess", ",", "zGuess", ",", "\[Lambda]2Guess"}], 
          "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"fullsol", "=", 
       RowBox[{"allVars", "/.", 
        RowBox[{"FindRoot", "[", 
         RowBox[{"goveqns", ",", 
          RowBox[{"Transpose", "[", 
           RowBox[{"{", 
            RowBox[{"allVars", ",", "guess"}], "}"}], "]"}], ",", 
          RowBox[{"DampingFactor", "\[Rule]", "1"}], ",", 
          RowBox[{"MaxIterations", "\[Rule]", "10000"}]}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"xsol", ",", "ysol", ",", "zsol", ",", "Tsol"}], "}"}], "=", 
       RowBox[{"fullsol", "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{"-", "4"}], ";;", 
          RowBox[{"-", "1"}]}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"vsol", "=", 
       RowBox[{"Drop", "[", 
        RowBox[{"fullsol", ",", 
         RowBox[{"-", "4"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"duds", "=", 
       RowBox[{
        RowBox[{"Sqrt", "[", 
         RowBox[{"1", "-", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"dfds", ".", "vsol"}], ")"}], "^", "2"}]}], "]"}], "-", 
        "1"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"usol", "=", 
       RowBox[{"ds", " ", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Total", "[", 
           RowBox[{"duds", "[", 
            RowBox[{"[", 
             RowBox[{"1", ";;", "i"}], "]"}], "]"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", 
            RowBox[{"Length", "@", "duds"}], ",", "1"}], "}"}]}], "]"}]}]}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"uAcc", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"usol", "-", 
             RowBox[{"(", 
              RowBox[{"initialU", "+", 
               RowBox[{"uVel", " ", "dt"}]}], ")"}]}], ")"}], "/", "dt"}], 
          "-", "uVel"}], ")"}], "/", "dt"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"vAcc", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"vsol", "-", 
             RowBox[{"(", 
              RowBox[{"initialV", "+", 
               RowBox[{"vVel", " ", "dt"}]}], ")"}]}], ")"}], "/", "dt"}], 
          "-", "vVel"}], ")"}], "/", "dt"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"xAcc", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"xsol", "-", 
             RowBox[{"(", 
              RowBox[{"xbob", "+", 
               RowBox[{"vx", " ", "dt"}]}], ")"}]}], ")"}], "/", "dt"}], "-", 
          "vx"}], ")"}], "/", "dt"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"yAcc", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"ysol", "-", 
             RowBox[{"(", 
              RowBox[{"ybob", "+", 
               RowBox[{"vy", " ", "dt"}]}], ")"}]}], ")"}], "/", "dt"}], "-", 
          "vy"}], ")"}], "/", "dt"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"zAcc", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"zsol", "-", 
             RowBox[{"(", 
              RowBox[{"zbob", "+", 
               RowBox[{"vz", " ", "dt"}]}], ")"}]}], ")"}], "/", "dt"}], "-", 
          "vz"}], ")"}], "/", "dt"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"aBob", "=", 
       RowBox[{"{", 
        RowBox[{"xAcc", ",", "yAcc", ",", "zAcc"}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"t", "<", "dt"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"nearestPos", "=", 
          RowBox[{"NearestSphere", "[", 
           RowBox[{
            RowBox[{"posbob", "+", 
             RowBox[{"velbob", " ", "dt"}]}], ",", "R"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"vNew", "=", 
          RowBox[{"initialV", "+", 
           RowBox[{"vVel", " ", "dt"}]}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"uNew", "=", 
          RowBox[{"initialU", "+", 
           RowBox[{"uVel", " ", "dt"}]}]}], ";"}], "\[IndentingNewLine]", ",",
         "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"nearestPos", "=", 
          RowBox[{"NearestSphere", "[", 
           RowBox[{
            RowBox[{"posbob", "+", 
             RowBox[{"velbobprevious", " ", "dt"}]}], ",", "R"}], "]"}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"vNew", "=", 
          RowBox[{"initialV", "+", 
           RowBox[{"vVel", " ", "dt"}]}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"uNew", "=", 
          RowBox[{"initialU", "+", 
           RowBox[{"uVel", " ", "dt"}]}]}], ";"}]}], "\[IndentingNewLine]", 
       "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"velbobprevious", "=", "velbob"}], ";", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"uNew", ",", "vNew", ",", 
        RowBox[{"uVel", "+", 
         RowBox[{"uAcc", " ", "dt"}]}], ",", 
        RowBox[{"vVel", "+", 
         RowBox[{"vAcc", " ", "dt"}]}], ",", "nearestPos", ",", 
        RowBox[{"velBob", "+", 
         RowBox[{"aBob", " ", "dt"}]}]}], "}"}]}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.7228155514121056`*^9, 3.722816748331434*^9}, {
   3.7228168031579566`*^9, 3.722816812381035*^9}, {3.7228169625195484`*^9, 
   3.7228169726618023`*^9}, {3.7228170128698907`*^9, 
   3.7228170817043505`*^9}, {3.7228172663967066`*^9, 3.722817272989252*^9}, {
   3.7228176904450426`*^9, 3.722817718755356*^9}, {3.7228180109608335`*^9, 
   3.722818042817509*^9}, {3.722825535020787*^9, 3.722825561505582*^9}, {
   3.7228269849103947`*^9, 3.722826985308013*^9}, {3.722827016812626*^9, 
   3.7228270178146567`*^9}, {3.722827154348901*^9, 3.7228271552395973`*^9}, {
   3.7228271893196745`*^9, 3.7228272302548423`*^9}, {3.7228281411940436`*^9, 
   3.7228281413569703`*^9}, {3.722828189849221*^9, 3.7228281899621077`*^9}, {
   3.7228282232706213`*^9, 3.7228282233328047`*^9}, {3.7228282862887993`*^9, 
   3.722828286400039*^9}, {3.7228286163131466`*^9, 3.722828641557206*^9}, {
   3.7228488319620256`*^9, 3.7228488327074184`*^9}, {3.7228511272128963`*^9, 
   3.722851128017001*^9}, {3.722853346610159*^9, 3.7228535135567718`*^9}, 
   3.722853675746127*^9, {3.722853757897629*^9, 3.722853786917714*^9}, {
   3.7228539479809*^9, 3.722853957620584*^9}, 3.72285483499294*^9, {
   3.7228564522430706`*^9, 3.722856452361562*^9}, {3.722856482984399*^9, 
   3.722856483163704*^9}, {3.722856789965412*^9, 3.722856940729224*^9}, {
   3.7228569712685947`*^9, 3.7228571664929695`*^9}, {3.7228571993839674`*^9, 
   3.7228572161964984`*^9}, {3.722902622372568*^9, 3.7229028067964616`*^9}, {
   3.7229029400899124`*^9, 3.7229029995038633`*^9}, {3.722903471760151*^9, 
   3.7229034722252283`*^9}, {3.7230371547011023`*^9, 3.723037160785838*^9}, {
   3.7230373300350637`*^9, 3.7230373479918957`*^9}, {3.7230375737579966`*^9, 
   3.7230376163278255`*^9}, {3.7240199130192175`*^9, 
   3.7240199133626137`*^9}, {3.7240199489076633`*^9, 3.724020038202119*^9}, {
   3.724020072875702*^9, 3.7240201014775486`*^9}, 3.7240201341555047`*^9, {
   3.7240202676411653`*^9, 3.7240202848097076`*^9}, {3.7242005056172123`*^9, 
   3.7242005057918186`*^9}, {3.7242982869065237`*^9, 
   3.7242983469224963`*^9}, {3.7243752488557854`*^9, 3.72437524913804*^9}, {
   3.7248174491400995`*^9, 3.7248174492473683`*^9}, {3.7248175476769085`*^9, 
   3.724817592507121*^9}, {3.7248176226474934`*^9, 3.724817661411933*^9}, 
   3.724819370901574*^9, {3.724820152106822*^9, 3.72482015882386*^9}, {
   3.7250755939953203`*^9, 3.7250756019855485`*^9}, {3.725075641837528*^9, 
   3.7250756467886724`*^9}, {3.7250757535236826`*^9, 
   3.7250757810786657`*^9}, {3.7250758232858276`*^9, 3.725075845219011*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Solve Equation", "Chapter",
 CellChangeTimes->{{3.7228167586612363`*^9, 3.722816764276204*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"n", "=", "30"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"initializeGrid", "[", 
   RowBox[{"n", ",", "l"}], "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"t", "=", "0."}], ";"}], "\n", 
 RowBox[{
  RowBox[{"dt", "=", "0.0002"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"tmax", "=", "100"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tmaxint", "=", "5"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ulist", "=", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"vlist", "=", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Theta]list", "=", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Phi]list", "=", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"xlist", "=", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ylist", "=", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"zlist", "=", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Tlist", "=", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"velboblist", "=", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"vVellist", "=", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"uVellist", "=", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"vAcclist", "=", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"uAcclist", "=", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Lambda]list", "=", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"tlist", "=", 
    RowBox[{"{", "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Theta]i", "=", 
   RowBox[{
    RowBox[{"30", " ", "Degree"}], "//", "N"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]i", "=", "0.01"}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"\[Theta]i", "=", "0.1"}], ";", "\[IndentingNewLine]", 
    RowBox[{"\[Phi]i", "=", 
     RowBox[{"0.2", "-", 
      RowBox[{"Pi", "/", "2"}]}]}], ";"}], "*)"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Omega]\[Theta]", "=", "0."}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Omega]\[Phi]", "=", "0."}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Alpha]\[Theta]", "=", "0."}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Alpha]\[Phi]", "=", "0."}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"posBob", "=", 
   RowBox[{"R", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"Sin", "[", "\[Theta]i", "]"}], 
       RowBox[{"Cos", "[", "\[Phi]i", "]"}]}], ",", 
      RowBox[{
       RowBox[{"Sin", "[", "\[Theta]i", "]"}], 
       RowBox[{"Sin", "[", "\[Phi]i", "]"}]}], ",", 
      RowBox[{"-", 
       RowBox[{"Cos", "[", "\[Theta]i", "]"}]}]}], "}"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"velBob", "=", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"0", ",", "0", ",", "0"}], "}"}], "//", "N"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"initialEnergy", "=", 
   RowBox[{"m", " ", "g", " ", 
    RowBox[{"posBob", "[", 
     RowBox[{"[", 
      RowBox[{"-", "1"}], "]"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"energylist", "=", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Tsol", "=", 
   RowBox[{"m", " ", "g"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Lambda]sol", "=", 
   RowBox[{"ConstantArray", "[", 
    RowBox[{"Tsol", ",", 
     RowBox[{"Length", "@", "sGrid"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"StaticSolve", "[", 
       RowBox[{"0", ",", 
        RowBox[{"0.05", "m", " ", "g"}]}], "]"}], "\n", "initialU"}], "=", 
     "usol"}], ";", "\[IndentingNewLine]", 
    RowBox[{"initialV", "=", "vsol"}], ";", "\[IndentingNewLine]", 
    RowBox[{"ListPlot", "[", "initialV", "]"}]}], "*)"}]}]}], "Input",
 CellChangeTimes->{
  3.7228167836958256`*^9, 3.722816848273794*^9, {3.7228172344930625`*^9, 
   3.72281723460662*^9}, {3.722817291157915*^9, 3.7228172920095234`*^9}, {
   3.7228173425595007`*^9, 3.7228173436818514`*^9}, {3.722817398536499*^9, 
   3.7228174235004206`*^9}, {3.7228176764354296`*^9, 
   3.7228177141277833`*^9}, {3.722817746448748*^9, 3.7228177467360573`*^9}, {
   3.7228178500055747`*^9, 3.7228178796341267`*^9}, {3.722817925511959*^9, 
   3.7228179325259757`*^9}, {3.722818065188013*^9, 3.7228180889211435`*^9}, {
   3.7228234642604237`*^9, 3.7228234680334597`*^9}, 3.722825566708543*^9, {
   3.7228264936406364`*^9, 3.722826494549425*^9}, {3.7228271607250032`*^9, 
   3.722827162360375*^9}, {3.7228282076819677`*^9, 3.722828210837679*^9}, {
   3.722828253632387*^9, 3.722828259465558*^9}, {3.722848842168723*^9, 
   3.7228488425733895`*^9}, {3.7228489047848206`*^9, 3.722848905079412*^9}, {
   3.722851613660204*^9, 3.722851614145648*^9}, 3.7228534271432776`*^9, 
   3.7228535167720947`*^9, {3.7228537138029904`*^9, 3.7228537148387737`*^9}, 
   3.722854077646926*^9, {3.722854581992077*^9, 3.722854582136582*^9}, 
   3.7228546489710054`*^9, {3.722854775411183*^9, 3.7228547778459387`*^9}, {
   3.722856030892025*^9, 3.7228560309351807`*^9}, {3.7228572796688447`*^9, 
   3.72285727989879*^9}, {3.722857413533182*^9, 3.722857443697033*^9}, {
   3.723036878188965*^9, 3.7230368837753215`*^9}, {3.723036924849699*^9, 
   3.7230369736786623`*^9}, {3.7230370211464715`*^9, 
   3.7230370514963174`*^9}, {3.7230370889294214`*^9, 
   3.7230370967262273`*^9}, {3.723100397027363*^9, 3.7231004696417403`*^9}, {
   3.7231083433690157`*^9, 3.723108346343749*^9}, {3.723127145342622*^9, 
   3.72312716976036*^9}, 3.723172970840643*^9, {3.723292837585821*^9, 
   3.723292844830062*^9}, {3.7232936043194404`*^9, 3.723293607406691*^9}, {
   3.723294896442331*^9, 3.72329489657026*^9}, 3.7232961315429077`*^9, 
   3.723334429646755*^9, {3.7233411834151554`*^9, 3.723341183631127*^9}, 
   3.72334182056324*^9, {3.723377697017214*^9, 3.7233776972197466`*^9}, {
   3.7233827021729565`*^9, 3.7233827029442987`*^9}, 3.723417996364506*^9, {
   3.7234180651109033`*^9, 3.7234180687884226`*^9}, {3.7234233343094826`*^9, 
   3.723423336803218*^9}, {3.7244334011681147`*^9, 3.724433404637296*^9}, {
   3.7244400120957007`*^9, 3.7244400198187847`*^9}, {3.7247954667958856`*^9, 
   3.7247954683547516`*^9}, {3.724795548163804*^9, 3.7247955488590984`*^9}, 
   3.7248177161563635`*^9, {3.7248184157936635`*^9, 3.724818420266982*^9}, {
   3.7248189006361575`*^9, 3.724818902087909*^9}, {3.7249140328638587`*^9, 
   3.724914037198713*^9}, {3.7249146428516893`*^9, 3.724914646708422*^9}, {
   3.7249149423896604`*^9, 3.724914942490307*^9}, {3.7249151392243547`*^9, 
   3.7249151401615458`*^9}, {3.724915474486989*^9, 3.7249154745721817`*^9}, {
   3.724915656956789*^9, 3.7249156704067655`*^9}, 3.7249160092130527`*^9, {
   3.7249167316157875`*^9, 3.7249167337115884`*^9}, {3.724920748375161*^9, 
   3.7249207485331273`*^9}, {3.724921237004655*^9, 3.724921237912583*^9}, {
   3.724921893397009*^9, 3.7249219025328255`*^9}, {3.7249227397340117`*^9, 
   3.724922739837474*^9}, {3.724923163061472*^9, 3.7249231631882944`*^9}, {
   3.724923917999075*^9, 3.7249239194544754`*^9}, {3.72492446587698*^9, 
   3.724924465984475*^9}, {3.724925117847164*^9, 3.724925125696432*^9}, {
   3.724927979963125*^9, 3.7249279803747854`*^9}, {3.7249284594839163`*^9, 
   3.7249284597508726`*^9}, {3.7249290367206106`*^9, 
   3.7249290369389915`*^9}, {3.7249299685713177`*^9, 
   3.7249299702237325`*^9}, {3.7249310994776306`*^9, 3.724931102933193*^9}, {
   3.724931368387847*^9, 3.7249313693414297`*^9}, {3.7249321991844997`*^9, 
   3.7249321993298874`*^9}, {3.7249336922311916`*^9, 
   3.7249336932067847`*^9}, {3.7249345992064323`*^9, 
   3.7249346003915806`*^9}, {3.724936709877944*^9, 3.7249367101857705`*^9}, {
   3.7249436880696006`*^9, 3.7249436938344684`*^9}, {3.724965315480686*^9, 
   3.724965342165641*^9}, {3.7250658620555477`*^9, 3.7250658827656565`*^9}, {
   3.725065953640439*^9, 3.725065953755745*^9}, 3.725074812951459*^9, {
   3.725074881455395*^9, 3.7250748830375896`*^9}, {3.7250766303024883`*^9, 
   3.725076655030961*^9}, {3.7250869853860207`*^9, 3.725086991393098*^9}, {
   3.7251057058495417`*^9, 3.7251057159015465`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Monitor", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"nstep", "=", "1"}], ";", "\[IndentingNewLine]", 
     RowBox[{"While", "[", 
      RowBox[{
       RowBox[{"t", "<", "tmax"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"While", "[", 
         RowBox[{
          RowBox[{"t", "<", 
           RowBox[{"nstep", " ", "tmaxint"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{"Print", "[", 
             RowBox[{"{", 
              RowBox[{"t", ",", "xb", ",", "yb", ",", "zb"}], "}"}], "]"}], 
            ";"}], "*)"}], "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{"xb", ",", "yb", ",", "zb"}], "}"}], "=", "posBob"}], 
           ";", "\[IndentingNewLine]", 
           RowBox[{"AppendTo", "[", 
            RowBox[{"ulist", ",", "initialU"}], "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"AppendTo", "[", 
            RowBox[{"vlist", ",", "initialV"}], "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"AppendTo", "[", 
            RowBox[{"xlist", ",", 
             RowBox[{"{", 
              RowBox[{"t", ",", "xb"}], "}"}]}], "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"AppendTo", "[", 
            RowBox[{"ylist", ",", 
             RowBox[{"{", 
              RowBox[{"t", ",", "yb"}], "}"}]}], "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"AppendTo", "[", 
            RowBox[{"zlist", ",", 
             RowBox[{"{", 
              RowBox[{"t", ",", "zb"}], "}"}]}], "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"AppendTo", "[", 
            RowBox[{"velboblist", ",", 
             RowBox[{"{", 
              RowBox[{"t", ",", "velBob"}], "}"}]}], "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"AppendTo", "[", 
            RowBox[{"vVellist", ",", "vVel"}], "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"AppendTo", "[", 
            RowBox[{"uVellist", ",", "uVel"}], "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"AppendTo", "[", 
            RowBox[{"vAcclist", ",", "vAcc"}], "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"AppendTo", "[", 
            RowBox[{"uAcclist", ",", "uAcc"}], "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"AppendTo", "[", 
            RowBox[{"\[Lambda]list", ",", "\[Lambda]sol"}], "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{"AppendTo", "[", 
              RowBox[{"\[Theta]list", ",", 
               RowBox[{"{", 
                RowBox[{"t", ",", "\[Theta]i"}], "}"}]}], "]"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"AppendTo", "[", 
              RowBox[{"\[Phi]list", ",", 
               RowBox[{"{", 
                RowBox[{"t", ",", "\[Phi]i"}], "}"}]}], "]"}], ";"}], "*)"}], 
           "\[IndentingNewLine]", 
           RowBox[{"AppendTo", "[", 
            RowBox[{"Tlist", ",", 
             RowBox[{"{", 
              RowBox[{"t", ",", "Tsol"}], "}"}]}], "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"AppendTo", "[", 
            RowBox[{"tlist", ",", "t"}], "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
             "initialU", ",", "initialV", ",", "uVel", ",", "vVel", ",", 
              "posBob", ",", "velBob"}], "}"}], "=", 
            RowBox[{"LinearConstant\[Lambda]1ExtraString", "[", 
             RowBox[{
             "initialU", ",", "initialV", ",", "uVel", ",", "vVel", ",", 
              "posBob", ",", "velBob", ",", "dt"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{"Print", "[", 
              RowBox[{"{", 
               RowBox[{"t", ",", 
                RowBox[{"vAcc", "[", 
                 RowBox[{"[", 
                  RowBox[{"-", "1"}], "]"}], "]"}], ",", 
                RowBox[{"\[Lambda]sol", "[", 
                 RowBox[{"[", 
                  RowBox[{"-", "1"}], "]"}], "]"}], ",", 
                RowBox[{"Tsol", " ", "ysol"}]}], "}"}], "]"}], ";"}], "*)"}], 
           "\[IndentingNewLine]", 
           RowBox[{"t", "+=", "dt"}], ";"}]}], " ", "\[IndentingNewLine]", 
         "]"}], ";", " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"ypos", "=", 
         RowBox[{
          RowBox[{"vlist", "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", 
             RowBox[{"-", "1"}]}], "]"}], "]"}], "+", 
          RowBox[{"ylist", "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", "2"}], "]"}], "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"yposframe", "=", 
         RowBox[{"ylist", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "2"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"xpos", "=", 
         RowBox[{
          RowBox[{"ulist", "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", 
             RowBox[{"-", "1"}]}], "]"}], "]"}], "+", 
          RowBox[{"xlist", "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", "2"}], "]"}], "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"zpos", "=", "zlist"}], ";", "\[IndentingNewLine]", 
        RowBox[{"ypos", "=", 
         RowBox[{"Transpose", "[", 
          RowBox[{"{", 
           RowBox[{"tlist", ",", "ypos"}], "}"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"yposframe", "=", 
         RowBox[{"Transpose", "[", 
          RowBox[{"{", 
           RowBox[{"tlist", ",", "yposframe"}], "}"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"xpos", "=", 
         RowBox[{"Transpose", "[", 
          RowBox[{"{", 
           RowBox[{"tlist", ",", "xpos"}], "}"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"timestepStr", "=", 
         RowBox[{"StringJoin", "[", 
          RowBox[{"\"\<time\>\"", ",", 
           RowBox[{"ToString", "@", "t"}], ",", "\"\<s\>\""}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Export", "[", 
         RowBox[{
          RowBox[{"StringJoin", "[", 
           RowBox[{"\"\<ylist\>\"", ",", "timestepStr", ",", "\"\<.csv\>\""}],
            "]"}], ",", "ypos"}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"Export", "[", 
         RowBox[{
          RowBox[{"StringJoin", "[", 
           RowBox[{
           "\"\<ylistframe\>\"", ",", "timestepStr", ",", "\"\<.csv\>\""}], 
           "]"}], ",", "yposframe"}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"Export", "[", 
         RowBox[{
          RowBox[{"StringJoin", "[", 
           RowBox[{"\"\<xlist\>\"", ",", "timestepStr", ",", "\"\<.csv\>\""}],
            "]"}], ",", "xpos"}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"Export", "[", 
         RowBox[{
          RowBox[{"StringJoin", "[", 
           RowBox[{"\"\<zlist\>\"", ",", "timestepStr", ",", "\"\<.csv\>\""}],
            "]"}], ",", "zpos"}], "]"}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"ulist", "=", 
         RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"vlist", "=", 
         RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"\[Theta]list", "=", 
         RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"\[Phi]list", "=", 
         RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"xlist", "=", 
         RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"ylist", "=", 
         RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"zlist", "=", 
         RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Tlist", "=", 
         RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"vVellist", "=", 
         RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"velboblist", "=", 
         RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"uVellist", "=", 
         RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"vAcclist", "=", 
         RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"uAcclist", "=", 
         RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"\[Lambda]list", "=", 
         RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"tlist", "=", 
         RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"nstep", "+=", "1"}], ";", "\[IndentingNewLine]", 
        RowBox[{"Print", "[", "t", "]"}], ";"}]}], "\[IndentingNewLine]", 
      "]"}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", ",", "t"}], 
   "]"}], ";"}]], "Input",
 CellChangeTimes->{
  3.722817001436474*^9, {3.722818090189478*^9, 3.7228180912162085`*^9}, 
   3.722825949931575*^9, {3.722829769961621*^9, 3.7228297742810774`*^9}, {
   3.722854288398464*^9, 3.722854352114029*^9}, {3.722854734815263*^9, 
   3.7228547688857665`*^9}, {3.7228572220610633`*^9, 3.722857234272229*^9}, {
   3.72290284283558*^9, 3.722902843305791*^9}, {3.723036902244976*^9, 
   3.7230369035023203`*^9}, {3.7230370079313264`*^9, 3.72303700952757*^9}, {
   3.723424290928638*^9, 3.7234242926256523`*^9}, {3.724020166362956*^9, 
   3.724020166663904*^9}, {3.724108108155067*^9, 3.7241081094629765`*^9}, 
   3.7249159961652822`*^9, {3.7249678879003716`*^9, 3.7249678891830645`*^9}, 
   3.725074872327704*^9, {3.725075329784583*^9, 3.7250753339280977`*^9}, 
   3.7250755079940524`*^9, {3.7250756982172785`*^9, 3.725075700074199*^9}, {
   3.7250758523067207`*^9, 3.725075852468457*^9}, {3.725233422515992*^9, 
   3.7252334587240567`*^9}}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"FindRoot", "::", "lstol"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"The line search decreased the step size to within \
tolerance specified by AccuracyGoal and PrecisionGoal but was unable to find \
a sufficient decrease in the merit function. You may need more than \
\[NoBreak]\\!\\(\\*RowBox[{\\\"MachinePrecision\\\"}]\\)\[NoBreak] digits of \
working precision to meet these tolerances. \\!\\(\\*ButtonBox[\\\"\
\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/FindRoot/lstol\\\", ButtonNote -> \
\\\"FindRoot::lstol\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{
  3.7243752671134386`*^9, 3.724375558426014*^9, 3.724385088287648*^9, 
   3.7244334093364077`*^9, 3.7244348127203856`*^9, 3.724440022910117*^9, 
   3.724554300019061*^9, 3.724817722150941*^9, 3.724818425826471*^9, 
   3.724818909798112*^9, 3.724819383389799*^9, 3.7248201694380198`*^9, 
   3.724914043531884*^9, 3.724914112164138*^9, 3.724914651691245*^9, 
   3.724914947322812*^9, 3.724915143829108*^9, 3.7249154878450136`*^9, 
   3.72491567328295*^9, 3.724916012515707*^9, 3.7249167368734226`*^9, 
   3.724920752555914*^9, 3.72492126834795*^9, 3.724921908742468*^9, 
   3.724922745622002*^9, 3.7249231688556013`*^9, 3.724923927158147*^9, 
   3.7249244704669847`*^9, 3.724925131772299*^9, 3.7249257188616405`*^9, 
   3.7249279869457245`*^9, 3.7249284633300257`*^9, 3.72492904202842*^9, 
   3.724929995428023*^9, 3.724931105271345*^9, 3.724931375798086*^9, 
   3.724932800370925*^9, 3.724933698355472*^9, 3.724934612425573*^9, 
   3.72493671384246*^9, 3.724937956717904*^9, 3.7249395590302496`*^9, 
   3.724941524680474*^9, 3.7249425390500355`*^9, 3.7249436969785566`*^9, 
   3.7249457511394215`*^9, 3.724965351186594*^9, 3.725065888995719*^9, {
   3.7250659351270485`*^9, 3.725065955938136*^9}, 3.7250748186672697`*^9, 
   3.7250749177883186`*^9, 3.725074995093292*^9, 3.725075136932585*^9, 
   3.725075509056611*^9, 3.7250755799869766`*^9, 3.725075884643011*^9, {
   3.7250766482162795`*^9, 3.7250766582152796`*^9}, 3.7250869951381454`*^9, 
   3.725105719341891*^9, 3.725106523942408*^9, 3.7251574578685684`*^9, 
   3.725179136875727*^9, 3.725181930884766*^9, 3.725233524895707*^9, 
   3.725233774755821*^9, 3.725234027634757*^9, 3.7255998431391225`*^9, 
   3.725615145060214*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"FindRoot", "::", "lstol"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"The line search decreased the step size to within \
tolerance specified by AccuracyGoal and PrecisionGoal but was unable to find \
a sufficient decrease in the merit function. You may need more than \
\[NoBreak]\\!\\(\\*RowBox[{\\\"MachinePrecision\\\"}]\\)\[NoBreak] digits of \
working precision to meet these tolerances. \\!\\(\\*ButtonBox[\\\"\
\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/FindRoot/lstol\\\", ButtonNote -> \
\\\"FindRoot::lstol\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{
  3.7243752671134386`*^9, 3.724375558426014*^9, 3.724385088287648*^9, 
   3.7244334093364077`*^9, 3.7244348127203856`*^9, 3.724440022910117*^9, 
   3.724554300019061*^9, 3.724817722150941*^9, 3.724818425826471*^9, 
   3.724818909798112*^9, 3.724819383389799*^9, 3.7248201694380198`*^9, 
   3.724914043531884*^9, 3.724914112164138*^9, 3.724914651691245*^9, 
   3.724914947322812*^9, 3.724915143829108*^9, 3.7249154878450136`*^9, 
   3.72491567328295*^9, 3.724916012515707*^9, 3.7249167368734226`*^9, 
   3.724920752555914*^9, 3.72492126834795*^9, 3.724921908742468*^9, 
   3.724922745622002*^9, 3.7249231688556013`*^9, 3.724923927158147*^9, 
   3.7249244704669847`*^9, 3.724925131772299*^9, 3.7249257188616405`*^9, 
   3.7249279869457245`*^9, 3.7249284633300257`*^9, 3.72492904202842*^9, 
   3.724929995428023*^9, 3.724931105271345*^9, 3.724931375798086*^9, 
   3.724932800370925*^9, 3.724933698355472*^9, 3.724934612425573*^9, 
   3.72493671384246*^9, 3.724937956717904*^9, 3.7249395590302496`*^9, 
   3.724941524680474*^9, 3.7249425390500355`*^9, 3.7249436969785566`*^9, 
   3.7249457511394215`*^9, 3.724965351186594*^9, 3.725065888995719*^9, {
   3.7250659351270485`*^9, 3.725065955938136*^9}, 3.7250748186672697`*^9, 
   3.7250749177883186`*^9, 3.725074995093292*^9, 3.725075136932585*^9, 
   3.725075509056611*^9, 3.7250755799869766`*^9, 3.725075884643011*^9, {
   3.7250766482162795`*^9, 3.7250766582152796`*^9}, 3.7250869951381454`*^9, 
   3.725105719341891*^9, 3.725106523942408*^9, 3.7251574578685684`*^9, 
   3.725179136875727*^9, 3.725181930884766*^9, 3.725233524895707*^9, 
   3.725233774755821*^9, 3.725234027634757*^9, 3.7255998431391225`*^9, 
   3.7256151458090286`*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"FindRoot", "::", "lstol"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"The line search decreased the step size to within \
tolerance specified by AccuracyGoal and PrecisionGoal but was unable to find \
a sufficient decrease in the merit function. You may need more than \
\[NoBreak]\\!\\(\\*RowBox[{\\\"MachinePrecision\\\"}]\\)\[NoBreak] digits of \
working precision to meet these tolerances. \\!\\(\\*ButtonBox[\\\"\
\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/FindRoot/lstol\\\", ButtonNote -> \
\\\"FindRoot::lstol\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{
  3.7243752671134386`*^9, 3.724375558426014*^9, 3.724385088287648*^9, 
   3.7244334093364077`*^9, 3.7244348127203856`*^9, 3.724440022910117*^9, 
   3.724554300019061*^9, 3.724817722150941*^9, 3.724818425826471*^9, 
   3.724818909798112*^9, 3.724819383389799*^9, 3.7248201694380198`*^9, 
   3.724914043531884*^9, 3.724914112164138*^9, 3.724914651691245*^9, 
   3.724914947322812*^9, 3.724915143829108*^9, 3.7249154878450136`*^9, 
   3.72491567328295*^9, 3.724916012515707*^9, 3.7249167368734226`*^9, 
   3.724920752555914*^9, 3.72492126834795*^9, 3.724921908742468*^9, 
   3.724922745622002*^9, 3.7249231688556013`*^9, 3.724923927158147*^9, 
   3.7249244704669847`*^9, 3.724925131772299*^9, 3.7249257188616405`*^9, 
   3.7249279869457245`*^9, 3.7249284633300257`*^9, 3.72492904202842*^9, 
   3.724929995428023*^9, 3.724931105271345*^9, 3.724931375798086*^9, 
   3.724932800370925*^9, 3.724933698355472*^9, 3.724934612425573*^9, 
   3.72493671384246*^9, 3.724937956717904*^9, 3.7249395590302496`*^9, 
   3.724941524680474*^9, 3.7249425390500355`*^9, 3.7249436969785566`*^9, 
   3.7249457511394215`*^9, 3.724965351186594*^9, 3.725065888995719*^9, {
   3.7250659351270485`*^9, 3.725065955938136*^9}, 3.7250748186672697`*^9, 
   3.7250749177883186`*^9, 3.725074995093292*^9, 3.725075136932585*^9, 
   3.725075509056611*^9, 3.7250755799869766`*^9, 3.725075884643011*^9, {
   3.7250766482162795`*^9, 3.7250766582152796`*^9}, 3.7250869951381454`*^9, 
   3.725105719341891*^9, 3.725106523942408*^9, 3.7251574578685684`*^9, 
   3.725179136875727*^9, 3.725181930884766*^9, 3.725233524895707*^9, 
   3.725233774755821*^9, 3.725234027634757*^9, 3.7255998431391225`*^9, 
   3.7256151458870296`*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"General", "::", "stop"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Further output of \
\[NoBreak]\\!\\(\\*StyleBox[RowBox[{\\\"FindRoot\\\", \\\"::\\\", \\\"lstol\\\
\"}], \\\"MessageName\\\"]\\)\[NoBreak] will be suppressed during this \
calculation. \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", \
ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/General/stop\\\", ButtonNote -> \
\\\"General::stop\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{
  3.7243752671134386`*^9, 3.724375558426014*^9, 3.724385088287648*^9, 
   3.7244334093364077`*^9, 3.7244348127203856`*^9, 3.724440022910117*^9, 
   3.724554300019061*^9, 3.724817722150941*^9, 3.724818425826471*^9, 
   3.724818909798112*^9, 3.724819383389799*^9, 3.7248201694380198`*^9, 
   3.724914043531884*^9, 3.724914112164138*^9, 3.724914651691245*^9, 
   3.724914947322812*^9, 3.724915143829108*^9, 3.7249154878450136`*^9, 
   3.72491567328295*^9, 3.724916012515707*^9, 3.7249167368734226`*^9, 
   3.724920752555914*^9, 3.72492126834795*^9, 3.724921908742468*^9, 
   3.724922745622002*^9, 3.7249231688556013`*^9, 3.724923927158147*^9, 
   3.7249244704669847`*^9, 3.724925131772299*^9, 3.7249257188616405`*^9, 
   3.7249279869457245`*^9, 3.7249284633300257`*^9, 3.72492904202842*^9, 
   3.724929995428023*^9, 3.724931105271345*^9, 3.724931375798086*^9, 
   3.724932800370925*^9, 3.724933698355472*^9, 3.724934612425573*^9, 
   3.72493671384246*^9, 3.724937956717904*^9, 3.7249395590302496`*^9, 
   3.724941524680474*^9, 3.7249425390500355`*^9, 3.7249436969785566`*^9, 
   3.7249457511394215`*^9, 3.724965351186594*^9, 3.725065888995719*^9, {
   3.7250659351270485`*^9, 3.725065955938136*^9}, 3.7250748186672697`*^9, 
   3.7250749177883186`*^9, 3.725074995093292*^9, 3.725075136932585*^9, 
   3.725075509056611*^9, 3.7250755799869766`*^9, 3.725075884643011*^9, {
   3.7250766482162795`*^9, 3.7250766582152796`*^9}, 3.7250869951381454`*^9, 
   3.725105719341891*^9, 3.725106523942408*^9, 3.7251574578685684`*^9, 
   3.725179136875727*^9, 3.725181930884766*^9, 3.725233524895707*^9, 
   3.725233774755821*^9, 3.725234027634757*^9, 3.7255998431391225`*^9, 
   3.725615145918231*^9}],

Cell[CellGroupData[{

Cell[BoxData["5.000000000001703`"], "Print",
 CellChangeTimes->{3.7252367107944407`*^9, 3.725600884087798*^9, 
  3.725615892000023*^9}],

Cell[BoxData["10.000000000003372`"], "Print",
 CellChangeTimes->{3.7252367107944407`*^9, 3.725600884087798*^9, 
  3.7256163896495934`*^9}],

Cell[BoxData["15.000199999991718`"], "Print",
 CellChangeTimes->{3.7252367107944407`*^9, 3.725600884087798*^9, 
  3.725616893804488*^9}],

Cell[BoxData["20.000199999980065`"], "Print",
 CellChangeTimes->{3.7252367107944407`*^9, 3.725600884087798*^9, 
  3.725617402623873*^9}],

Cell[BoxData["25.000199999968412`"], "Print",
 CellChangeTimes->{3.7252367107944407`*^9, 3.725600884087798*^9, 
  3.7256179134400964`*^9}],

Cell[BoxData["30.00019999995676`"], "Print",
 CellChangeTimes->{3.7252367107944407`*^9, 3.725600884087798*^9, 
  3.7256184247399287`*^9}],

Cell[BoxData["35.00019999994511`"], "Print",
 CellChangeTimes->{3.7252367107944407`*^9, 3.725600884087798*^9, 
  3.7256189412970624`*^9}],

Cell[BoxData["40.00019999993346`"], "Print",
 CellChangeTimes->{3.7252367107944407`*^9, 3.725600884087798*^9, 
  3.725619460539448*^9}],

Cell[BoxData["45.000199999921804`"], "Print",
 CellChangeTimes->{3.7252367107944407`*^9, 3.725600884087798*^9, 
  3.7256199838671117`*^9}],

Cell[BoxData["50.00019999991015`"], "Print",
 CellChangeTimes->{3.7252367107944407`*^9, 3.725600884087798*^9, 
  3.725620508926409*^9}],

Cell[BoxData["55.0001999998985`"], "Print",
 CellChangeTimes->{3.7252367107944407`*^9, 3.725600884087798*^9, 
  3.7256210361229467`*^9}],

Cell[BoxData["60.000199999886846`"], "Print",
 CellChangeTimes->{3.7252367107944407`*^9, 3.725600884087798*^9, 
  3.7256215650531187`*^9}],

Cell[BoxData["65.00019999991072`"], "Print",
 CellChangeTimes->{3.7252367107944407`*^9, 3.725600884087798*^9, 
  3.725622098739382*^9}],

Cell[BoxData["70.0000000000767`"], "Print",
 CellChangeTimes->{3.7252367107944407`*^9, 3.725600884087798*^9, 
  3.725622634219679*^9}],

Cell[BoxData["75.00000000024268`"], "Print",
 CellChangeTimes->{3.7252367107944407`*^9, 3.725600884087798*^9, 
  3.7256231734908495`*^9}],

Cell[BoxData["80.00000000040866`"], "Print",
 CellChangeTimes->{3.7252367107944407`*^9, 3.725600884087798*^9, 
  3.72562371486806*^9}],

Cell[BoxData["85.00000000057464`"], "Print",
 CellChangeTimes->{3.7252367107944407`*^9, 3.725600884087798*^9, 
  3.7256242602555485`*^9}],

Cell[BoxData["90.00000000074063`"], "Print",
 CellChangeTimes->{3.7252367107944407`*^9, 3.725600884087798*^9, 
  3.725624815018817*^9}],

Cell[BoxData["95.00000000090661`"], "Print",
 CellChangeTimes->{3.7252367107944407`*^9, 3.725600884087798*^9, 
  3.72562536686683*^9}],

Cell[BoxData["100.00000000107259`"], "Print",
 CellChangeTimes->{3.7252367107944407`*^9, 3.725600884087798*^9, 
  3.725625920320743*^9}]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
Evaluator->"New Kernel2",
WindowSize->{1916, 998},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
FrontEndVersion->"10.3 for Microsoft Windows (64-bit) (December 10, 2015)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 126, 1, 72, "Chapter"],
Cell[709, 25, 12878, 345, 1455, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[13624, 375, 106, 1, 72, "Chapter"],
Cell[CellGroupData[{
Cell[13755, 380, 11753, 291, 1111, "Input"],
Cell[25511, 673, 2746, 37, 31, "Output"],
Cell[28260, 712, 2746, 37, 31, "Output"],
Cell[31009, 751, 2746, 37, 31, "Output"],
Cell[33758, 790, 2746, 37, 31, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[36553, 833, 103, 1, 72, "Chapter"],
Cell[36659, 836, 72881, 1868, 7267, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[109577, 2709, 101, 1, 72, "Chapter"],
Cell[109681, 2712, 8581, 193, 852, "Input"],
Cell[CellGroupData[{
Cell[118287, 2909, 9859, 225, 1192, "Input"],
Cell[128149, 3136, 2370, 37, 21, "Message"],
Cell[130522, 3175, 2372, 37, 21, "Message"],
Cell[132897, 3214, 2372, 37, 21, "Message"],
Cell[135272, 3253, 2225, 36, 21, "Message"],
Cell[CellGroupData[{
Cell[137522, 3293, 135, 2, 23, "Print"],
Cell[137660, 3297, 138, 2, 23, "Print"],
Cell[137801, 3301, 136, 2, 23, "Print"],
Cell[137940, 3305, 136, 2, 23, "Print"],
Cell[138079, 3309, 138, 2, 23, "Print"],
Cell[138220, 3313, 137, 2, 23, "Print"],
Cell[138360, 3317, 137, 2, 23, "Print"],
Cell[138500, 3321, 135, 2, 23, "Print"],
Cell[138638, 3325, 138, 2, 23, "Print"],
Cell[138779, 3329, 135, 2, 23, "Print"],
Cell[138917, 3333, 136, 2, 23, "Print"],
Cell[139056, 3337, 138, 2, 23, "Print"],
Cell[139197, 3341, 135, 2, 23, "Print"],
Cell[139335, 3345, 134, 2, 23, "Print"],
Cell[139472, 3349, 137, 2, 23, "Print"],
Cell[139612, 3353, 134, 2, 23, "Print"],
Cell[139749, 3357, 137, 2, 23, "Print"],
Cell[139889, 3361, 135, 2, 23, "Print"],
Cell[140027, 3365, 134, 2, 23, "Print"],
Cell[140164, 3369, 136, 2, 23, "Print"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

